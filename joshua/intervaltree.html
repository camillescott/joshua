<!DOCTYPE html>
<!-- Generated by Cython 0.22.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: intervaltree.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.22.1</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="intervaltree.c">intervaltree.c</a></p>
<div class="cython"><pre class='cython line score-0'>&#xA0;001: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;002: <span class="sd">Data structure for performing intersect queries on a set of intervals which</span></pre>
<pre class='cython line score-0'>&#xA0;003: <span class="sd">preserves all information about the intervals (unlike bitset projection methods).</span></pre>
<pre class='cython line score-0'>&#xA0;004: </pre>
<pre class='cython line score-0'>&#xA0;005: <span class="sd">:Authors: Camille Scott (camille.scott.w@gmail.com),</span></pre>
<pre class='cython line score-0'>&#xA0;006: <span class="sd">          James Taylor (james@jamestaylor.org),</span></pre>
<pre class='cython line score-0'>&#xA0;007: <span class="sd">          Ian Schenk (ian.schenck@gmail.com),</span></pre>
<pre class='cython line score-0'>&#xA0;008: <span class="sd">          Brent Pedersen (bpederse@gmail.com)</span></pre>
<pre class='cython line score-0'>&#xA0;009: <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;010: </pre>
<pre class='cython line score-0'>&#xA0;011: <span class="c"># Historical note:</span></pre>
<pre class='cython line score-0'>&#xA0;012: <span class="c">#    This module original contained an implementation based on sorted endpoints</span></pre>
<pre class='cython line score-0'>&#xA0;013: <span class="c">#    and a binary search, using an idea from Scott Schwartz and Piotr Berman.</span></pre>
<pre class='cython line score-0'>&#xA0;014: <span class="c">#    Later an interval tree implementation was implemented by Ian for Galaxy&#39;s</span></pre>
<pre class='cython line score-0'>&#xA0;015: <span class="c">#    join tool (see `bx.intervals.operations.quicksect.py`). This was then</span></pre>
<pre class='cython line score-0'>&#xA0;016: <span class="c">#    converted to Cython by Brent, who also added support for</span></pre>
<pre class='cython line score-0'>&#xA0;017: <span class="c">#    upstream/downstream/neighbor queries. This was modified by James to</span></pre>
<pre class='cython line score-0'>&#xA0;018: <span class="c">#    handle half-open intervals strictly, to maintain sort order, and to</span></pre>
<pre class='cython line score-0'>&#xA0;019: <span class="c">#    implement the same interface as the original Intersecter.</span></pre>
<pre class='cython line score-0'>&#xA0;020: </pre>
<pre class='cython line score-0'>&#xA0;021: <span class="c">#cython: cdivision=True</span></pre>
<pre class='cython line score-0'>&#xA0;022: </pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+023: <span class="k">import</span> <span class="nn">operator</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_operator, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_operator, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-29' onclick='toggleDiv(this)'>+024: <span class="k">from</span> <span class="nn">utils</span> <span class="k">import</span> <span class="n">calc_bases_overlapped_single</span><span class="p">,</span> \</pre>
<pre class='cython code score-29'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_calc_bases_overlapped_single);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_calc_bases_overlapped_single);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_calc_bases_overlapped_single);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_calc_bases_overlapped_mult);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_calc_bases_overlapped_mult);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_calc_bases_overlapped_mult);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_utils, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_calc_bases_overlapped_single);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calc_bases_overlapped_single, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_calc_bases_overlapped_mult);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 24; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_calc_bases_overlapped_mult, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;025:                   <span class="n">calc_bases_overlapped_mult</span></pre>
<pre class='cython line score-0'>&#xA0;026: </pre>
<pre class='cython line score-0'>&#xA0;027: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;stdlib.h&quot;</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;028:     <span class="nb">int</span> <span class="n">ceil</span><span class="p">(</span><span class="nb">float</span> <span class="n">f</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;029:     <span class="nb">float</span> <span class="n">log</span><span class="p">(</span><span class="nb">float</span> <span class="n">f</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;030:     <span class="nb">int</span> <span class="n">RAND_MAX</span></pre>
<pre class='cython line score-0'>&#xA0;031:     <span class="nb">int</span> <span class="n">rand</span><span class="p">()</span></pre>
<pre class='cython line score-0'>&#xA0;032:     <span class="nb">int</span> <span class="n">strlen</span><span class="p">(</span><span class="n">char</span> <span class="o">*</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;033:     <span class="nb">int</span> <span class="n">iabs</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;034: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+035: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">imax2</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">):</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE int __pyx_f_6joshua_12intervaltree_imax2(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("imax2", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+036:     <span class="k">if</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span> <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_b &gt; __pyx_v_a) != 0);
  if (__pyx_t_1) {
    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+037:     <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_a;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;038: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+039: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">imax3</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">,</span> <span class="nb">int</span> <span class="n">c</span><span class="p">):</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE int __pyx_f_6joshua_12intervaltree_imax3(int __pyx_v_a, int __pyx_v_b, int __pyx_v_c) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("imax3", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+040:     <span class="k">if</span> <span class="n">b</span> <span class="o">&gt;</span> <span class="n">a</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_b &gt; __pyx_v_a) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+041:         <span class="k">if</span> <span class="n">c</span> <span class="o">&gt;</span> <span class="n">b</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_1 = ((__pyx_v_c &gt; __pyx_v_b) != 0);
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+042:             <span class="k">return</span> <span class="n">c</span></pre>
<pre class='cython code score-0'>      __pyx_r = __pyx_v_c;
      goto __pyx_L0;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+043:         <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+044:     <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="n">c</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_a &gt; __pyx_v_c) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+045:         <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_v_a;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+046:     <span class="k">return</span> <span class="n">c</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_c;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;047: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+048: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">imin3</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">,</span> <span class="nb">int</span> <span class="n">c</span><span class="p">):</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE int __pyx_f_6joshua_12intervaltree_imin3(int __pyx_v_a, int __pyx_v_b, int __pyx_v_c) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("imin3", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+049:     <span class="k">if</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_b &lt; __pyx_v_a) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+050:         <span class="k">if</span> <span class="n">c</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_1 = ((__pyx_v_c &lt; __pyx_v_b) != 0);
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+051:             <span class="k">return</span> <span class="n">c</span></pre>
<pre class='cython code score-0'>      __pyx_r = __pyx_v_c;
      goto __pyx_L0;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+052:         <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+053:     <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_a &lt; __pyx_v_c) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+054:         <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0'>    __pyx_r = __pyx_v_a;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+055:     <span class="k">return</span> <span class="n">c</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_c;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;056: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+057: <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">int</span> <span class="nf">imin2</span><span class="p">(</span><span class="nb">int</span> <span class="n">a</span><span class="p">,</span> <span class="nb">int</span> <span class="n">b</span><span class="p">):</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE int __pyx_f_6joshua_12intervaltree_imin2(int __pyx_v_a, int __pyx_v_b) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("imin2", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+058:     <span class="k">if</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">a</span><span class="p">:</span> <span class="k">return</span> <span class="n">b</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_b &lt; __pyx_v_a) != 0);
  if (__pyx_t_1) {
    __pyx_r = __pyx_v_b;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+059:     <span class="k">return</span> <span class="n">a</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_a;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;060: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+061: <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">nlog</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">log</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = log(0.5);
  if (unlikely(__pyx_t_3 == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 61; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_6joshua_12intervaltree_nlog = (-1.0 / __pyx_t_3);
</pre><pre class='cython line score-0'>&#xA0;062: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+063: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">IntervalNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_obj_6joshua_12intervaltree_IntervalNode {
  PyObject_HEAD
  struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *__pyx_vtab;
  float priority;
  PyObject *interval;
  int start;
  int end;
  int length;
  int minend;
  int maxend;
  int minstart;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *cleft;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *cright;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *croot;
};
/* … */
struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode {
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *(*insert)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, int, int, PyObject *, int __pyx_skip_dispatch);
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *(*rotate_right)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *);
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *(*rotate_left)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *);
  void (*set_ends)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *);
  void (*_intersect)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, int, int, PyObject *);
  void (*_seek_left)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, int, PyObject *, int, int);
  void (*_seek_right)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, int, PyObject *, int, int);
  PyObject *(*left)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_6joshua_12intervaltree_12IntervalNode_left *__pyx_optional_args);
  PyObject *(*right)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, PyObject *, int __pyx_skip_dispatch, struct __pyx_opt_args_6joshua_12intervaltree_12IntervalNode_right *__pyx_optional_args);
  void (*_traverse)(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *, PyObject *, PyObject *);
};
static struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *__pyx_vtabptr_6joshua_12intervaltree_IntervalNode;
</pre><pre class='cython line score-0'>&#xA0;064:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;065: <span class="sd">    A single node of an `IntervalTree`.</span></pre>
<pre class='cython line score-0'>&#xA0;066: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;067: <span class="sd">    NOTE: Unless you really know what you are doing, you probably should us</span></pre>
<pre class='cython line score-0'>&#xA0;068: <span class="sd">          `IntervalTree` rather than using this directly. </span></pre>
<pre class='cython line score-0'>&#xA0;069: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;070:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">priority</span></pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+071:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">object</span> <span class="nf">interval</span></pre>
<pre class='cython code score-6'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_8interval_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_8interval_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_8interval___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_8interval___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;interval);
  __pyx_r = __pyx_v_self-&gt;interval;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_8interval_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_8interval_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_8interval_2__set__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalNode_8interval_2__set__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;interval);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;interval);
  __pyx_v_self-&gt;interval = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_8interval_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_8interval_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_8interval_4__del__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalNode_8interval_4__del__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;interval);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;interval);
  __pyx_v_self-&gt;interval = Py_None;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-30' onclick='toggleDiv(this)'>+072:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">int</span> <span class="nf">start</span><span class="p">,</span> <span class="nf">end</span><span class="p">,</span> <span class="nf">length</span></pre>
<pre class='cython code score-30'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_5start_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_5start_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_5start___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_5start___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.start.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_5start_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_5start_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_5start_2__set__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalNode_5start_2__set__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;start = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.start.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_3end_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_3end_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_3end___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_3end___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;end);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.end.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_3end_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_3end_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_3end_2__set__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalNode_3end_2__set__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;end = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.end.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_6length_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_6length_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_6length___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_6length___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.length.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_6length_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_6length_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_6length_2__set__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalNode_6length_2__set__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 72; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;length = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.length.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;073:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">minend</span><span class="p">,</span> <span class="nf">maxend</span><span class="p">,</span> <span class="nf">minstart</span></pre>
<pre class='cython line score-0'>&#xA0;074:     <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">cleft</span><span class="p">,</span> <span class="nf">cright</span><span class="p">,</span> <span class="nf">croot</span></pre>
<pre class='cython line score-0'>&#xA0;075: </pre>
<pre class='cython line score-0'>&#xA0;076:     <span class="k">property</span> <span class="nf">left_node</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+077:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9left_node_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9left_node_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_9left_node___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_9left_node___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+078:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span> <span class="k">else</span> <span class="bp">None</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  if ((__pyx_t_2 != 0)) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;cleft));
    __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;cleft);
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_t_1 = Py_None;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;079:     <span class="k">property</span> <span class="nf">right_node</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+080:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_10right_node_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_10right_node_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_10right_node___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_10right_node___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+081:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span> <span class="k">else</span> <span class="bp">None</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  if ((__pyx_t_2 != 0)) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;cright));
    __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;cright);
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_t_1 = Py_None;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;082:     <span class="k">property</span> <span class="nf">root_node</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+083:         <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9root_node_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9root_node_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_9root_node___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_9root_node___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+084:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">croot</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">croot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span> <span class="k">else</span> <span class="bp">None</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = (__pyx_v_self-&gt;croot != __pyx_v_6joshua_12intervaltree_EmptyNode);
  if ((__pyx_t_2 != 0)) {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self-&gt;croot));
    __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;croot);
  } else {
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_t_1 = Py_None;
  }
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;085: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+086:     <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-5'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_1__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_1__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode___repr__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode___repr__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-15' onclick='toggleDiv(this)'>+087:         <span class="k">return</span> <span class="s">&quot;IntervalNode(</span><span class="si">%i</span><span class="s">, </span><span class="si">%i</span><span class="s">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">)</span></pre>
<pre class='cython code score-15'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;end);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_IntervalNode_i_i, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 87; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;088: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+089:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">start</span><span class="p">,</span> <span class="nb">int</span> <span class="n">end</span><span class="p">,</span> <span class="nb">object</span> <span class="n">interval</span><span class="p">):</span></pre>
<pre class='cython code score-45'>/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalNode_3__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start;
  int __pyx_v_end;
  PyObject *__pyx_v_interval = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start,&amp;__pyx_n_s_end,&amp;__pyx_n_s_interval,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_interval)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__cinit__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_start = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_interval = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 89; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_2__cinit__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), __pyx_v_start, __pyx_v_end, __pyx_v_interval);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalNode_2__cinit__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, PyObject *__pyx_v_interval) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.__cinit__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;090:         <span class="c"># Python lacks the binomial distribution, so we convert a</span></pre>
<pre class='cython line score-0'>&#xA0;091:         <span class="c"># uniform into a binomial because it naturally scales with</span></pre>
<pre class='cython line score-0'>&#xA0;092:         <span class="c"># tree size.  Also, python&#39;s uniform is perfect since the</span></pre>
<pre class='cython line score-0'>&#xA0;093:         <span class="c"># upper limit is not inclusive, which gives us undefined here.</span></pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+094:         <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">nlog</span> <span class="o">*</span> <span class="n">log</span><span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="o">/</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">rand</span><span class="p">()</span><span class="o">/</span><span class="n">RAND_MAX</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)))</span></pre>
<pre class='cython code score-10'>  __pyx_t_1 = (1.0 * rand());
  if (unlikely(RAND_MAX == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_t_2 = ((__pyx_t_1 / RAND_MAX) - 1.0);
  if (unlikely(__pyx_t_2 == 0)) {
    #ifdef WITH_THREAD
    PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
    #endif
    <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
    #ifdef WITH_THREAD
    PyGILState_Release(__pyx_gilstate_save);
    #endif
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 94; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  __pyx_v_self-&gt;priority = ceil((__pyx_v_6joshua_12intervaltree_nlog * log((-1.0 / __pyx_t_2))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+095:         <span class="bp">self</span><span class="o">.</span><span class="n">start</span>    <span class="o">=</span> <span class="n">start</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;start = __pyx_v_start;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+096:         <span class="bp">self</span><span class="o">.</span><span class="n">end</span>      <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;end = __pyx_v_end;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+097:         <span class="bp">self</span><span class="o">.</span><span class="n">length</span>   <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;length = (__pyx_v_end - __pyx_v_start);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+098:         <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="o">=</span> <span class="n">interval</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_interval);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_interval);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;interval);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;interval);
  __pyx_v_self-&gt;interval = __pyx_v_interval;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+099:         <span class="bp">self</span><span class="o">.</span><span class="n">maxend</span>   <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;maxend = __pyx_v_end;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+100:         <span class="bp">self</span><span class="o">.</span><span class="n">minstart</span> <span class="o">=</span> <span class="n">start</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;minstart = __pyx_v_start;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+101:         <span class="bp">self</span><span class="o">.</span><span class="n">minend</span>   <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;minend = __pyx_v_end;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+102:         <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span>    <span class="o">=</span> <span class="n">EmptyNode</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cleft);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cleft));
  __pyx_v_self-&gt;cleft = __pyx_v_6joshua_12intervaltree_EmptyNode;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+103:         <span class="bp">self</span><span class="o">.</span><span class="n">cright</span>   <span class="o">=</span> <span class="n">EmptyNode</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cright);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cright));
  __pyx_v_self-&gt;cright = __pyx_v_6joshua_12intervaltree_EmptyNode;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+104:         <span class="bp">self</span><span class="o">.</span><span class="n">croot</span>    <span class="o">=</span> <span class="n">EmptyNode</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;croot);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;croot));
  __pyx_v_self-&gt;croot = __pyx_v_6joshua_12intervaltree_EmptyNode;
</pre><pre class='cython line score-0'>&#xA0;105: </pre>
<pre class='cython line score-93' onclick='toggleDiv(this)'>+106:     <span class="k">cpdef</span> <span class="kt">IntervalNode</span> <span class="nf">insert</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">start</span><span class="p">,</span> <span class="nb">int</span> <span class="n">end</span><span class="p">,</span> <span class="nb">object</span> <span class="n">interval</span><span class="p">):</span></pre>
<pre class='cython code score-93'>static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_5insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_f_6joshua_12intervaltree_12IntervalNode_insert(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, PyObject *__pyx_v_interval, int __pyx_skip_dispatch) {
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_croot = 0;
  int __pyx_v_decision_endpoint;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert", 0);
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_6joshua_12intervaltree_12IntervalNode_5insert)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_interval);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_interval);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_v_interval);
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      if (!(likely(((__pyx_t_2) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_2, __pyx_ptype_6joshua_12intervaltree_IntervalNode))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      __pyx_r = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_croot);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_5insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalNode_4insert[] = "\n        Insert a new IntervalNode into the tree of which this node is\n        currently the root. The return value is the new root of the tree (which\n        may or may not be this node!)\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_5insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start;
  int __pyx_v_end;
  PyObject *__pyx_v_interval = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start,&amp;__pyx_n_s_end,&amp;__pyx_n_s_interval,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 1, 3, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_interval)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 1, 3, 3, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "insert") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 3) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
    }
    __pyx_v_start = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_interval = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 1, 3, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_4insert(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), __pyx_v_start, __pyx_v_end, __pyx_v_interval);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_4insert(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, PyObject *__pyx_v_interval) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((PyObject *)__pyx_f_6joshua_12intervaltree_12IntervalNode_insert(__pyx_v_self, __pyx_v_start, __pyx_v_end, __pyx_v_interval, 1));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;107:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;108: <span class="sd">        Insert a new IntervalNode into the tree of which this node is</span></pre>
<pre class='cython line score-0'>&#xA0;109: <span class="sd">        currently the root. The return value is the new root of the tree (which</span></pre>
<pre class='cython line score-0'>&#xA0;110: <span class="sd">        may or may not be this node!)</span></pre>
<pre class='cython line score-0'>&#xA0;111: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+112:         <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">croot</span> <span class="o">=</span> <span class="bp">self</span></pre>
<pre class='cython code score-1'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  __pyx_v_croot = __pyx_v_self;
</pre><pre class='cython line score-0'>&#xA0;113:         <span class="c"># If starts are the same, decide which to add interval to based on</span></pre>
<pre class='cython line score-0'>&#xA0;114:         <span class="c"># end, thus maintaining sortedness relative to start/end</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+115:         <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">decision_endpoint</span> <span class="o">=</span> <span class="n">start</span></pre>
<pre class='cython code score-0'>  __pyx_v_decision_endpoint = __pyx_v_start;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+116:         <span class="k">if</span> <span class="n">start</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = ((__pyx_v_start == __pyx_v_self-&gt;start) != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+117:             <span class="n">decision_endpoint</span> <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0'>    __pyx_v_decision_endpoint = __pyx_v_end;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;118: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+119:         <span class="k">if</span> <span class="n">decision_endpoint</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_9 = ((__pyx_v_decision_endpoint &gt; __pyx_v_self-&gt;start) != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-0'>&#xA0;120:             <span class="c"># insert to cright tree</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+121:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_9 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
    __pyx_t_10 = (__pyx_t_9 != 0);
    if (__pyx_t_10) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+122:                 <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval</span> <span class="p">)</span></pre>
<pre class='cython code score-1'>      __pyx_t_1 = ((PyObject *)((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cright-&gt;__pyx_vtab)-&gt;insert(__pyx_v_self-&gt;cright, __pyx_v_start, __pyx_v_end, __pyx_v_interval, 0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cright);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cright));
      __pyx_v_self-&gt;cright = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_1);
      __pyx_t_1 = 0;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;123:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-17' onclick='toggleDiv(this)'>+124:                 <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="o">=</span> <span class="n">IntervalNode</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval</span> <span class="p">)</span></pre>
<pre class='cython code score-17'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_interval);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_interval);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_interval);
      __pyx_t_1 = 0;
      __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalNode)), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cright);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cright));
      __pyx_v_self-&gt;cright = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_2);
      __pyx_t_2 = 0;
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;125:             <span class="c"># rebalance tree</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+126:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">priority</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = ((__pyx_v_self-&gt;priority &lt; __pyx_v_self-&gt;cright-&gt;priority) != 0);
    if (__pyx_t_10) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+127:                 <span class="n">croot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_left</span><span class="p">()</span></pre>
<pre class='cython code score-1'>      __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;rotate_left(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 127; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_croot, ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_2));
      __pyx_t_2 = 0;
      goto __pyx_L6;
    }
    __pyx_L6:;
    goto __pyx_L4;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;128:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;129:             <span class="c"># insert to cleft tree</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+130:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_10 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
    __pyx_t_9 = (__pyx_t_10 != 0);
    if (__pyx_t_9) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+131:                 <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span></pre>
<pre class='cython code score-1'>      __pyx_t_2 = ((PyObject *)((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cleft-&gt;__pyx_vtab)-&gt;insert(__pyx_v_self-&gt;cleft, __pyx_v_start, __pyx_v_end, __pyx_v_interval, 0));<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 131; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cleft);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cleft));
      __pyx_v_self-&gt;cleft = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_2);
      __pyx_t_2 = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;132:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-17' onclick='toggleDiv(this)'>+133:                 <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="o">=</span> <span class="n">IntervalNode</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span></pre>
<pre class='cython code score-17'>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_interval);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_interval);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_v_interval);
      __pyx_t_2 = 0;
      __pyx_t_5 = 0;
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalNode)), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 133; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cleft);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cleft));
      __pyx_v_self-&gt;cleft = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_5);
      __pyx_t_5 = 0;
    }
    __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;134:             <span class="c"># rebalance tree</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+135:             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">priority</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_9 = ((__pyx_v_self-&gt;priority &lt; __pyx_v_self-&gt;cleft-&gt;priority) != 0);
    if (__pyx_t_9) {
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+136:                 <span class="n">croot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_right</span><span class="p">()</span></pre>
<pre class='cython code score-1'>      __pyx_t_5 = ((PyObject *)((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;rotate_right(__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 136; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_croot, ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_5));
      __pyx_t_5 = 0;
      goto __pyx_L8;
    }
    __pyx_L8:;
  }
  __pyx_L4:;
</pre><pre class='cython line score-0'>&#xA0;137: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+138:         <span class="n">croot</span><span class="o">.</span><span class="n">set_ends</span><span class="p">()</span></pre>
<pre class='cython code score-0'>  __pyx_f_6joshua_12intervaltree_12IntervalNode_set_ends(__pyx_v_croot);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+139:         <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">croot</span>  <span class="o">=</span> <span class="n">croot</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_croot));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_croot));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cleft-&gt;croot);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cleft-&gt;croot));
  __pyx_v_self-&gt;cleft-&gt;croot = __pyx_v_croot;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+140:         <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">croot</span> <span class="o">=</span> <span class="n">croot</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_croot));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_croot));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cright-&gt;croot);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cright-&gt;croot));
  __pyx_v_self-&gt;cright-&gt;croot = __pyx_v_croot;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+141:         <span class="k">return</span> <span class="n">croot</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_croot));
  __pyx_r = __pyx_v_croot;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;142: </pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+143:     <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">rotate_right</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1'>static struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_f_6joshua_12intervaltree_12IntervalNode_rotate_right(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_croot = 0;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate_right", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_croot);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+144:         <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">croot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span></pre>
<pre class='cython code score-1'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;cleft);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_croot = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+145:         <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">cright</span></pre>
<pre class='cython code score-2'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;cleft-&gt;cright);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cleft);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cleft));
  __pyx_v_self-&gt;cleft = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+146:         <span class="n">croot</span><span class="o">.</span><span class="n">cright</span> <span class="o">=</span> <span class="bp">self</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_croot-&gt;cright);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_croot-&gt;cright));
  __pyx_v_croot-&gt;cright = __pyx_v_self;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+147:         <span class="bp">self</span><span class="o">.</span><span class="n">set_ends</span><span class="p">()</span></pre>
<pre class='cython code score-0'>  __pyx_f_6joshua_12intervaltree_12IntervalNode_set_ends(__pyx_v_self);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+148:         <span class="k">return</span> <span class="n">croot</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_croot));
  __pyx_r = __pyx_v_croot;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;149: </pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+150:     <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">rotate_left</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-1'>static struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_f_6joshua_12intervaltree_12IntervalNode_rotate_left(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_croot = 0;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("rotate_left", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>((PyObject *)__pyx_v_croot);
  <span class='refnanny'>__Pyx_XGIVEREF</span>((PyObject *)__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+151:         <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">croot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span></pre>
<pre class='cython code score-1'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;cright);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_croot = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+152:         <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">cleft</span></pre>
<pre class='cython code score-2'>  __pyx_t_1 = ((PyObject *)__pyx_v_self-&gt;cright-&gt;cleft);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;cright);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;cright));
  __pyx_v_self-&gt;cright = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+153:         <span class="n">croot</span><span class="o">.</span><span class="n">cleft</span>  <span class="o">=</span> <span class="bp">self</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_croot-&gt;cleft);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_croot-&gt;cleft));
  __pyx_v_croot-&gt;cleft = __pyx_v_self;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+154:         <span class="bp">self</span><span class="o">.</span><span class="n">set_ends</span><span class="p">()</span></pre>
<pre class='cython code score-0'>  __pyx_f_6joshua_12intervaltree_12IntervalNode_set_ends(__pyx_v_self);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+155:         <span class="k">return</span> <span class="n">croot</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(((PyObject *)__pyx_r));
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_croot));
  __pyx_r = __pyx_v_croot;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;156: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+157:     <span class="k">cdef</span> <span class="kr">inline</span> <span class="kt">void</span> <span class="nf">set_ends</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0'>static CYTHON_INLINE void __pyx_f_6joshua_12intervaltree_12IntervalNode_set_ends(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("set_ends", 0);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+158:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_3 != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+159:             <span class="bp">self</span><span class="o">.</span><span class="n">maxend</span> <span class="o">=</span> <span class="n">imax3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">maxend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">maxend</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;maxend = __pyx_f_6joshua_12intervaltree_imax3(__pyx_v_self-&gt;end, __pyx_v_self-&gt;cright-&gt;maxend, __pyx_v_self-&gt;cleft-&gt;maxend);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+160:             <span class="bp">self</span><span class="o">.</span><span class="n">minend</span> <span class="o">=</span> <span class="n">imin3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">minend</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">minend</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;minend = __pyx_f_6joshua_12intervaltree_imin3(__pyx_v_self-&gt;end, __pyx_v_self-&gt;cright-&gt;minend, __pyx_v_self-&gt;cleft-&gt;minend);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+161:             <span class="bp">self</span><span class="o">.</span><span class="n">minstart</span> <span class="o">=</span> <span class="n">imin3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">minstart</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">minstart</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;minstart = __pyx_f_6joshua_12intervaltree_imin3(__pyx_v_self-&gt;start, __pyx_v_self-&gt;cright-&gt;minstart, __pyx_v_self-&gt;cleft-&gt;minstart);
    goto __pyx_L3;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+162:         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+163:             <span class="bp">self</span><span class="o">.</span><span class="n">maxend</span> <span class="o">=</span> <span class="n">imax2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">maxend</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;maxend = __pyx_f_6joshua_12intervaltree_imax2(__pyx_v_self-&gt;end, __pyx_v_self-&gt;cright-&gt;maxend);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+164:             <span class="bp">self</span><span class="o">.</span><span class="n">minend</span> <span class="o">=</span> <span class="n">imin2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">minend</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;minend = __pyx_f_6joshua_12intervaltree_imin2(__pyx_v_self-&gt;end, __pyx_v_self-&gt;cright-&gt;minend);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+165:             <span class="bp">self</span><span class="o">.</span><span class="n">minstart</span> <span class="o">=</span> <span class="n">imin2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">minstart</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;minstart = __pyx_f_6joshua_12intervaltree_imin2(__pyx_v_self-&gt;start, __pyx_v_self-&gt;cright-&gt;minstart);
    goto __pyx_L3;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+166:         <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+167:             <span class="bp">self</span><span class="o">.</span><span class="n">maxend</span> <span class="o">=</span> <span class="n">imax2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">maxend</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;maxend = __pyx_f_6joshua_12intervaltree_imax2(__pyx_v_self-&gt;end, __pyx_v_self-&gt;cleft-&gt;maxend);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+168:             <span class="bp">self</span><span class="o">.</span><span class="n">minend</span> <span class="o">=</span> <span class="n">imin2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">minend</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;minend = __pyx_f_6joshua_12intervaltree_imin2(__pyx_v_self-&gt;end, __pyx_v_self-&gt;cleft-&gt;minend);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+169:             <span class="bp">self</span><span class="o">.</span><span class="n">minstart</span> <span class="o">=</span> <span class="n">imin2</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">minstart</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_self-&gt;minstart = __pyx_f_6joshua_12intervaltree_imin2(__pyx_v_self-&gt;start, __pyx_v_self-&gt;cleft-&gt;minstart);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;170: </pre>
<pre class='cython line score-0'>&#xA0;171: </pre>
<pre class='cython line score-45' onclick='toggleDiv(this)'>+172:     <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">start</span><span class="p">,</span> <span class="nb">int</span> <span class="n">end</span><span class="p">,</span> <span class="n">sort</span><span class="o">=</span><span class="bp">True</span> <span class="p">):</span></pre>
<pre class='cython code score-45'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_7intersect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalNode_6intersect[] = "\n        given a start and a end, return a list of features\n        falling within that range\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_7intersect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start;
  int __pyx_v_end;
  CYTHON_UNUSED PyObject *__pyx_v_sort = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start,&amp;__pyx_n_s_end,&amp;__pyx_n_s_sort,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)Py_True);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersect", 0, 2, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sort);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersect") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_start = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_sort = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersect", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 172; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_6intersect(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), __pyx_v_start, __pyx_v_end, __pyx_v_sort);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_6intersect(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, CYTHON_UNUSED PyObject *__pyx_v_sort) {
  PyObject *__pyx_v_results = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;173:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;174: <span class="sd">        given a start and a end, return a list of features</span></pre>
<pre class='cython line score-0'>&#xA0;175: <span class="sd">        falling within that range</span></pre>
<pre class='cython line score-0'>&#xA0;176: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+177:         <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">results</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 177; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+178:         <span class="bp">self</span><span class="o">.</span><span class="n">_intersect</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">results</span> <span class="p">)</span></pre>
<pre class='cython code score-0'>  ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_intersect(__pyx_v_self, __pyx_v_start, __pyx_v_end, __pyx_v_results);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+179:         <span class="k">return</span> <span class="n">results</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
  __pyx_r = __pyx_v_results;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;180: </pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+181:     <span class="n">find</span> <span class="o">=</span> <span class="n">intersect</span></pre>
<pre class='cython code score-13'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetNameInClass</span>((PyObject *)__pyx_ptype_6joshua_12intervaltree_IntervalNode, __pyx_n_s_intersect);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6joshua_12intervaltree_IntervalNode-&gt;tp_dict, __pyx_n_s_find, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 181; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6joshua_12intervaltree_IntervalNode);
</pre><pre class='cython line score-0'>&#xA0;182: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+183:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_intersect</span><span class="p">(</span> <span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">start</span><span class="p">,</span> <span class="nb">int</span> <span class="n">end</span><span class="p">,</span> <span class="nb">list</span> <span class="n">results</span><span class="p">):</span></pre>
<pre class='cython code score-3'>static void __pyx_f_6joshua_12intervaltree_12IntervalNode__intersect(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, PyObject *__pyx_v_results) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_intersect", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("joshua.intervaltree.IntervalNode._intersect", __pyx_clineno, __pyx_lineno, __pyx_filename, 0, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='cython line score-0'>&#xA0;184:         <span class="c"># Left subtree</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+185:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">maxend</span> <span class="o">&gt;</span> <span class="n">start</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_3 = (__pyx_t_2 != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_3 = ((__pyx_v_self-&gt;cleft-&gt;maxend &gt; __pyx_v_start) != 0);
  __pyx_t_1 = __pyx_t_3;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+186:             <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">_intersect</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">results</span> <span class="p">)</span></pre>
<pre class='cython code score-0'>    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cleft-&gt;__pyx_vtab)-&gt;_intersect(__pyx_v_self-&gt;cleft, __pyx_v_start, __pyx_v_end, __pyx_v_results);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;187:         <span class="c"># This interval</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+188:         <span class="k">if</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">start</span> <span class="p">)</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span> <span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = ((__pyx_v_self-&gt;end &gt; __pyx_v_start) != 0);
  if (__pyx_t_3) {
  } else {
    __pyx_t_1 = __pyx_t_3;
    goto __pyx_L7_bool_binop_done;
  }
  __pyx_t_3 = ((__pyx_v_self-&gt;start &lt; __pyx_v_end) != 0);
  __pyx_t_1 = __pyx_t_3;
  __pyx_L7_bool_binop_done:;
  if (__pyx_t_1) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+189:             <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span> <span class="p">)</span></pre>
<pre class='cython code score-9'>    if (unlikely(__pyx_v_results == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_4 = __pyx_v_self-&gt;interval;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 189; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;190:         <span class="c"># Right subtree</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+191:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">end</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_3 != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L10_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_self-&gt;start &lt; __pyx_v_end) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L10_bool_binop_done:;
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+192:             <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">_intersect</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">results</span> <span class="p">)</span></pre>
<pre class='cython code score-0'>    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cright-&gt;__pyx_vtab)-&gt;_intersect(__pyx_v_self-&gt;cright, __pyx_v_start, __pyx_v_end, __pyx_v_results);
    goto __pyx_L9;
  }
  __pyx_L9:;
</pre><pre class='cython line score-0'>&#xA0;193: </pre>
<pre class='cython line score-0'>&#xA0;194: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+195:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_seek_left</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">position</span><span class="p">,</span> <span class="nb">list</span> <span class="n">results</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="p">,</span> <span class="nb">int</span> <span class="n">max_dist</span><span class="p">):</span></pre>
<pre class='cython code score-3'>static void __pyx_f_6joshua_12intervaltree_12IntervalNode__seek_left(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_position, PyObject *__pyx_v_results, int __pyx_v_n, int __pyx_v_max_dist) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_seek_left", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("joshua.intervaltree.IntervalNode._seek_left", __pyx_clineno, __pyx_lineno, __pyx_filename, 0, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='cython line score-0'>&#xA0;196:         <span class="c"># we know we can bail in these 2 cases.</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+197:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxend</span> <span class="o">+</span> <span class="n">max_dist</span> <span class="o">&lt;</span> <span class="n">position</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_self-&gt;maxend + __pyx_v_max_dist) &lt; __pyx_v_position) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+198:             <span class="k">return</span></pre>
<pre class='cython code score-0'>    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+199:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minstart</span> <span class="o">&gt;</span> <span class="n">position</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_self-&gt;minstart &gt; __pyx_v_position) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+200:             <span class="k">return</span></pre>
<pre class='cython code score-0'>    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;201: </pre>
<pre class='cython line score-0'>&#xA0;202:         <span class="c"># the ordering of these 3 blocks makes it so the results are</span></pre>
<pre class='cython line score-0'>&#xA0;203:         <span class="c"># ordered nearest to farest from the query position</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+204:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+205:             <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">_seek_left</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cright-&gt;__pyx_vtab)-&gt;_seek_left(__pyx_v_self-&gt;cright, __pyx_v_position, __pyx_v_results, __pyx_v_n, __pyx_v_max_dist);
    goto __pyx_L5;
  }
  __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;206: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+207:         <span class="k">if</span> <span class="o">-</span><span class="mf">1</span> <span class="o">&lt;</span> <span class="n">position</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;</span> <span class="n">max_dist</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_position - __pyx_v_self-&gt;end);
  __pyx_t_2 = (-1 &lt; __pyx_t_3);
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_t_3 &lt; __pyx_v_max_dist);
  }
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+208:             <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    if (unlikely(__pyx_v_results == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_4 = __pyx_v_self-&gt;interval;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 208; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;209: </pre>
<pre class='cython line score-0'>&#xA0;210:         <span class="c"># TODO: can these conditionals be more stringent?</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+211:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+212:                 <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">_seek_left</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cleft-&gt;__pyx_vtab)-&gt;_seek_left(__pyx_v_self-&gt;cleft, __pyx_v_position, __pyx_v_results, __pyx_v_n, __pyx_v_max_dist);
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;213: </pre>
<pre class='cython line score-0'>&#xA0;214: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+215:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_seek_right</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">position</span><span class="p">,</span> <span class="nb">list</span> <span class="n">results</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="p">,</span> <span class="nb">int</span> <span class="n">max_dist</span><span class="p">):</span></pre>
<pre class='cython code score-3'>static void __pyx_f_6joshua_12intervaltree_12IntervalNode__seek_right(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, int __pyx_v_position, PyObject *__pyx_v_results, int __pyx_v_n, int __pyx_v_max_dist) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_seek_right", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("joshua.intervaltree.IntervalNode._seek_right", __pyx_clineno, __pyx_lineno, __pyx_filename, 0, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='cython line score-0'>&#xA0;216:         <span class="c"># we know we can bail in these 2 cases.</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+217:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maxend</span> <span class="o">&lt;</span> <span class="n">position</span><span class="p">:</span> <span class="k">return</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_self-&gt;maxend &lt; __pyx_v_position) != 0);
  if (__pyx_t_1) {
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+218:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">minstart</span> <span class="o">-</span> <span class="n">max_dist</span> <span class="o">&gt;</span> <span class="n">position</span><span class="p">:</span> <span class="k">return</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_self-&gt;minstart - __pyx_v_max_dist) &gt; __pyx_v_position) != 0);
  if (__pyx_t_1) {
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;219: </pre>
<pre class='cython line score-0'>&#xA0;220:         <span class="c">#print &quot;SEEK_RIGHT:&quot;,self, self.cleft, self.maxend, self.minstart, position</span></pre>
<pre class='cython line score-0'>&#xA0;221: </pre>
<pre class='cython line score-0'>&#xA0;222:         <span class="c"># the ordering of these 3 blocks makes it so the results are</span></pre>
<pre class='cython line score-0'>&#xA0;223:         <span class="c"># ordered nearest to farest from the query position</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+224:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+225:                 <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">_seek_right</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cleft-&gt;__pyx_vtab)-&gt;_seek_right(__pyx_v_self-&gt;cleft, __pyx_v_position, __pyx_v_results, __pyx_v_n, __pyx_v_max_dist);
    goto __pyx_L5;
  }
  __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;226: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+227:         <span class="k">if</span> <span class="o">-</span><span class="mf">1</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">-</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="n">max_dist</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_self-&gt;start - __pyx_v_position);
  __pyx_t_2 = (-1 &lt; __pyx_t_3);
  if (__pyx_t_2) {
    __pyx_t_2 = (__pyx_t_3 &lt; __pyx_v_max_dist);
  }
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+228:             <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">interval</span><span class="p">)</span></pre>
<pre class='cython code score-9'>    if (unlikely(__pyx_v_results == Py_None)) {
      <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_4 = __pyx_v_self-&gt;interval;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 228; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L6;
  }
  __pyx_L6:;
</pre><pre class='cython line score-0'>&#xA0;229: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+230:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+231:                 <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">_seek_right</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cright-&gt;__pyx_vtab)-&gt;_seek_right(__pyx_v_self-&gt;cright, __pyx_v_position, __pyx_v_results, __pyx_v_n, __pyx_v_max_dist);
    goto __pyx_L7;
  }
  __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;232: </pre>
<pre class='cython line score-0'>&#xA0;233: </pre>
<pre class='cython line score-88' onclick='toggleDiv(this)'>+234:     <span class="k">cpdef</span> <span class="nf">left</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span><span class="p">):</span></pre>
<pre class='cython code score-88'>static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9left(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6joshua_12intervaltree_12IntervalNode_left(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_position, int __pyx_skip_dispatch, struct __pyx_opt_args_6joshua_12intervaltree_12IntervalNode_left *__pyx_optional_args) {
  int __pyx_v_n = ((int)1);
  int __pyx_v_max_dist = ((int)2500);
  PyObject *__pyx_v_results = 0;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("left", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_n = __pyx_optional_args-&gt;n;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_max_dist = __pyx_optional_args-&gt;max_dist;
      }
    }
  }
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_left);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_6joshua_12intervaltree_12IntervalNode_9left)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_position);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_position);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_v_position);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.left", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9left(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalNode_8left[] = "\n        find n features with a start &gt; than `position`\n        f: a Interval object (or anything with an `end` attribute)\n        n: the number of features to return\n        max_dist: the maximum distance to look before giving up.\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_9left(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_position = 0;
  int __pyx_v_n;
  int __pyx_v_max_dist;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("left (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position,&amp;__pyx_n_s_n,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_position)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "left") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_position = values[0];
    if (values[1]) {
      __pyx_v_n = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_n == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_n = ((int)1);
    }
    if (values[2]) {
      __pyx_v_max_dist = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_max_dist == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_max_dist = ((int)2500);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("left", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.left", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_8left(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), __pyx_v_position, __pyx_v_n, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_8left(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_position, int __pyx_v_n, int __pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("left", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 2;
  __pyx_t_2.n = __pyx_v_n;
  __pyx_t_2.max_dist = __pyx_v_max_dist;
  __pyx_t_1 = __pyx_vtabptr_6joshua_12intervaltree_IntervalNode-&gt;left(__pyx_v_self, __pyx_v_position, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 234; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.left", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_6joshua_12intervaltree_12IntervalNode_left {
  int __pyx_n;
  int n;
  int max_dist;
};
</pre><pre class='cython line score-0'>&#xA0;235:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;236: <span class="sd">        find n features with a start &gt; than `position`</span></pre>
<pre class='cython line score-0'>&#xA0;237: <span class="sd">        f: a Interval object (or anything with an `end` attribute)</span></pre>
<pre class='cython line score-0'>&#xA0;238: <span class="sd">        n: the number of features to return</span></pre>
<pre class='cython line score-0'>&#xA0;239: <span class="sd">        max_dist: the maximum distance to look before giving up.</span></pre>
<pre class='cython line score-0'>&#xA0;240: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+241:         <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">results</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 241; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;242:         <span class="c"># use start - 1 becuase .left() assumes strictly left-of</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+243:         <span class="bp">self</span><span class="o">.</span><span class="n">_seek_left</span><span class="p">(</span> <span class="n">position</span> <span class="o">-</span> <span class="mf">1</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_v_position, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 243; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_seek_left(__pyx_v_self, __pyx_t_9, __pyx_v_results, __pyx_v_n, __pyx_v_max_dist);
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+244:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span> <span class="k">return</span> <span class="n">results</span></pre>
<pre class='cython code score-3'>  __pyx_t_7 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_results);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 244; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_10 = ((__pyx_t_7 == __pyx_v_n) != 0);
  if (__pyx_t_10) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
    __pyx_r = __pyx_v_results;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+245:         <span class="n">r</span> <span class="o">=</span> <span class="n">results</span></pre>
<pre class='cython code score-1'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
  __pyx_v_r = __pyx_v_results;
</pre><pre class='cython line score-36' onclick='toggleDiv(this)'>+246:         <span class="n">r</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&#39;end&#39;</span><span class="p">),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span></pre>
<pre class='cython code score-36'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_r, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_operator);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_attrgetter);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_key, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_reverse, Py_True) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 246; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+247:         <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_GetSlice</span>(__pyx_v_r, 0, __pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 247; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;248: </pre>
<pre class='cython line score-88' onclick='toggleDiv(this)'>+249:     <span class="k">cpdef</span> <span class="nf">right</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="nb">int</span> <span class="n">n</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="nb">int</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span><span class="p">):</span></pre>
<pre class='cython code score-88'>static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_11right(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_f_6joshua_12intervaltree_12IntervalNode_right(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_position, int __pyx_skip_dispatch, struct __pyx_opt_args_6joshua_12intervaltree_12IntervalNode_right *__pyx_optional_args) {
  int __pyx_v_n = ((int)1);
  int __pyx_v_max_dist = ((int)2500);
  PyObject *__pyx_v_results = 0;
  PyObject *__pyx_v_r = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("right", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_n = __pyx_optional_args-&gt;n;
      if (__pyx_optional_args-&gt;__pyx_n &gt; 1) {
        __pyx_v_max_dist = __pyx_optional_args-&gt;max_dist;
      }
    }
  }
  /* Check if called by wrapper */
  if (unlikely(__pyx_skip_dispatch)) ;
  /* Check if overridden in Python */
  else if (unlikely(Py_TYPE(((PyObject *)__pyx_v_self))-&gt;tp_dictoffset != 0)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_right);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!PyCFunction_Check(__pyx_t_1) || (PyCFunction_GET_FUNCTION(__pyx_t_1) != (PyCFunction)__pyx_pw_6joshua_12intervaltree_12IntervalNode_11right)) {
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      __pyx_t_5 = __pyx_t_1; __pyx_t_6 = NULL;
      __pyx_t_7 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
        __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
        if (likely(__pyx_t_6)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
          __pyx_t_7 = 1;
        }
      }
      __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      if (__pyx_t_6) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_position);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_position);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_v_position);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_7, __pyx_t_4);
      __pyx_t_3 = 0;
      __pyx_t_4 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_5, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_r = __pyx_t_2;
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      goto __pyx_L0;
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.right", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_11right(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalNode_10right[] = "\n        find n features with a end &lt; than position\n        f: a Interval object (or anything with a `start` attribute)\n        n: the number of features to return\n        max_dist: the maximum distance to look before giving up.\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_11right(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_position = 0;
  int __pyx_v_n;
  int __pyx_v_max_dist;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("right (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position,&amp;__pyx_n_s_n,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_position)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_n);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "right") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_position = values[0];
    if (values[1]) {
      __pyx_v_n = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_n == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_n = ((int)1);
    }
    if (values[2]) {
      __pyx_v_max_dist = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_max_dist == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_max_dist = ((int)2500);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("right", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.right", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_10right(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), __pyx_v_position, __pyx_v_n, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_10right(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_position, int __pyx_v_n, int __pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("right", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2.__pyx_n = 2;
  __pyx_t_2.n = __pyx_v_n;
  __pyx_t_2.max_dist = __pyx_v_max_dist;
  __pyx_t_1 = __pyx_vtabptr_6joshua_12intervaltree_IntervalNode-&gt;right(__pyx_v_self, __pyx_v_position, 1, &amp;__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 249; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.right", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_6joshua_12intervaltree_12IntervalNode_14generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value); /* proto */
/* … */
struct __pyx_opt_args_6joshua_12intervaltree_12IntervalNode_right {
  int __pyx_n;
  int n;
  int max_dist;
};
</pre><pre class='cython line score-0'>&#xA0;250:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;251: <span class="sd">        find n features with a end &lt; than position</span></pre>
<pre class='cython line score-0'>&#xA0;252: <span class="sd">        f: a Interval object (or anything with a `start` attribute)</span></pre>
<pre class='cython line score-0'>&#xA0;253: <span class="sd">        n: the number of features to return</span></pre>
<pre class='cython line score-0'>&#xA0;254: <span class="sd">        max_dist: the maximum distance to look before giving up.</span></pre>
<pre class='cython line score-0'>&#xA0;255: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+256:         <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">results</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 256; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;257:         <span class="c"># use end + 1 becuase .right() assumes strictly right-of</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+258:         <span class="bp">self</span><span class="o">.</span><span class="n">_seek_right</span><span class="p">(</span><span class="n">position</span> <span class="o">+</span> <span class="mf">1</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">max_dist</span><span class="p">)</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_v_position, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 258; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_seek_right(__pyx_v_self, __pyx_t_9, __pyx_v_results, __pyx_v_n, __pyx_v_max_dist);
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+259:         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="n">n</span><span class="p">:</span> <span class="k">return</span> <span class="n">results</span></pre>
<pre class='cython code score-3'>  __pyx_t_7 = <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_results);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 259; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_10 = ((__pyx_t_7 == __pyx_v_n) != 0);
  if (__pyx_t_10) {
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
    __pyx_r = __pyx_v_results;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+260:         <span class="n">r</span> <span class="o">=</span> <span class="n">results</span></pre>
<pre class='cython code score-1'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
  __pyx_v_r = __pyx_v_results;
</pre><pre class='cython line score-31' onclick='toggleDiv(this)'>+261:         <span class="n">r</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">operator</span><span class="o">.</span><span class="n">attrgetter</span><span class="p">(</span><span class="s">&#39;start&#39;</span><span class="p">))</span></pre>
<pre class='cython code score-31'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_r, __pyx_n_s_sort);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_operator);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_attrgetter);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_s_key, __pyx_t_5) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_empty_tuple, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 261; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+262:         <span class="k">return</span> <span class="n">r</span><span class="p">[:</span><span class="n">n</span><span class="p">]</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyList_GetSlice</span>(__pyx_v_r, 0, __pyx_v_n);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 262; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;263: </pre>
<pre class='cython line score-23' onclick='toggleDiv(this)'>+264:     <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-23'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_13__iter__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_13__iter__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_12__iter__(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_12__iter__(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self) {
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct____iter__ *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__", 0);
  __pyx_cur_scope = (struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct____iter__ *)__pyx_tp_new_6joshua_12intervaltree___pyx_scope_struct____iter__(__pyx_ptype_6joshua_12intervaltree___pyx_scope_struct____iter__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  __pyx_cur_scope-&gt;__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  {
    __pyx_GeneratorObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_generator_body_t) __pyx_gb_6joshua_12intervaltree_12IntervalNode_14generator, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_IntervalNode___iter);<span class='error_goto'> if (unlikely(!gen)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_6joshua_12intervaltree_12IntervalNode_14generator(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("None", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 264; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
  /* function exit code */
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Generator_clear</span>((PyObject*)__pyx_generator);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
}
/* … */
struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct____iter__ {
  PyObject_HEAD
  PyObject *__pyx_v_e;
  PyObject *__pyx_v_iv;
  PyObject *__pyx_v_s;
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self;
  PyObject *__pyx_t_0;
  Py_ssize_t __pyx_t_1;
  PyObject *(*__pyx_t_2)(PyObject *);
};

</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+265:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_cur_scope-&gt;__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-99' onclick='toggleDiv(this)'>+266:             <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">iv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="p">:</span></pre>
<pre class='cython code score-99'>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cleft))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cleft))) {
      __pyx_t_3 = ((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cleft); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cleft));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
          if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_5(__pyx_t_3);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
        PyObject* sequence = __pyx_t_6;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 3)) {
          if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          __pyx_t_9 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        } else {
          __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          __pyx_t_9 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
        #else
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_9 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_11 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
        index = 0; __pyx_t_7 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_7)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        index = 1; __pyx_t_8 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        index = 2; __pyx_t_9 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_9)) goto __pyx_L7_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_10), 3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L8_unpacking_done;
        __pyx_L7_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 266; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L8_unpacking_done:;
      }
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_s);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_s, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      __pyx_t_7 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_e);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_e, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_iv, __pyx_t_9);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
      __pyx_t_9 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+267:                 <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">iv</span></pre>
<pre class='cython code score-11'>      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_s);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_s);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_cur_scope-&gt;__pyx_v_s);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_e);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_e);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_cur_scope-&gt;__pyx_v_e);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_cur_scope-&gt;__pyx_v_iv);
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
      __pyx_cur_scope-&gt;__pyx_t_0 = __pyx_t_3;
      __pyx_cur_scope-&gt;__pyx_t_1 = __pyx_t_4;
      __pyx_cur_scope-&gt;__pyx_t_2 = __pyx_t_5;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
      <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
      /* return from generator, yielding value */
      __pyx_generator-&gt;resume_label = 1;
      return __pyx_r;
      __pyx_L9_resume_from_yield:;
      __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_t_0;
      __pyx_cur_scope-&gt;__pyx_t_0 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
      __pyx_t_4 = __pyx_cur_scope-&gt;__pyx_t_1;
      __pyx_t_5 = __pyx_cur_scope-&gt;__pyx_t_2;
      if (unlikely(!__pyx_sent_value)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+268:         <span class="k">yield</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">interval</span></pre>
<pre class='cython code score-13'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;end);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;interval);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;interval);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2, __pyx_cur_scope-&gt;__pyx_v_self-&gt;interval);
  __pyx_t_3 = 0;
  __pyx_t_6 = 0;
  __pyx_r = __pyx_t_9;
  __pyx_t_9 = 0;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  /* return from generator, yielding value */
  __pyx_generator-&gt;resume_label = 2;
  return __pyx_r;
  __pyx_L10_resume_from_yield:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+269:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_cur_scope-&gt;__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-99' onclick='toggleDiv(this)'>+270:             <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">iv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="p">:</span></pre>
<pre class='cython code score-99'>    if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cright))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cright))) {
      __pyx_t_9 = ((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cright); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9); __pyx_t_4 = 0;
      __pyx_t_5 = NULL;
    } else {
      __pyx_t_4 = -1; __pyx_t_9 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;cright));<span class='error_goto'> if (unlikely(!__pyx_t_9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
      __pyx_t_5 = Py_TYPE(__pyx_t_9)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    for (;;) {
      if (likely(!__pyx_t_5)) {
        if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_9))) {
          if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_9, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
        } else {
          if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_9)) break;
          #if CYTHON_COMPILING_IN_CPYTHON
          __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_9, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          #else
          __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_9, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          #endif
        }
      } else {
        __pyx_t_6 = __pyx_t_5(__pyx_t_9);
        if (unlikely(!__pyx_t_6)) {
          PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
          if (exc_type) {
            if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
            else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
          }
          break;
        }
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      }
      if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_6))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_6))) {
        PyObject* sequence = __pyx_t_6;
        #if CYTHON_COMPILING_IN_CPYTHON
        Py_ssize_t size = Py_SIZE(sequence);
        #else
        Py_ssize_t size = <span class='py_c_api'>PySequence_Size</span>(sequence);
        #endif
        if (unlikely(size != 3)) {
          if (size &gt; 3) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(3);
          else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        #if CYTHON_COMPILING_IN_CPYTHON
        if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
          __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
          __pyx_t_8 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
          __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 2); 
        } else {
          __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
          __pyx_t_8 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
          __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 2); 
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_8 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        #endif
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      } else {
        Py_ssize_t index = -1;
        __pyx_t_10 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        __pyx_t_11 = Py_TYPE(__pyx_t_10)-&gt;tp_iternext;
        index = 0; __pyx_t_3 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_3)) goto __pyx_L14_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        index = 1; __pyx_t_8 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_8)) goto __pyx_L14_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        index = 2; __pyx_t_7 = __pyx_t_11(__pyx_t_10); if (unlikely(!__pyx_t_7)) goto __pyx_L14_unpacking_failed;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
        if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_11(__pyx_t_10), 3) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_t_11 = NULL;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L15_unpacking_done;
        __pyx_L14_unpacking_failed:;
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        __pyx_t_11 = NULL;
        if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 270; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        __pyx_L15_unpacking_done:;
      }
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_s);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_s, __pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      __pyx_t_3 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_e);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_e, __pyx_t_8);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
      __pyx_t_8 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_iv, __pyx_t_7);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
      __pyx_t_7 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+271:                 <span class="k">yield</span> <span class="n">s</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">iv</span></pre>
<pre class='cython code score-11'>      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_s);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_s);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_cur_scope-&gt;__pyx_v_s);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_e);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_e);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_cur_scope-&gt;__pyx_v_e);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_cur_scope-&gt;__pyx_v_iv);
      __pyx_r = __pyx_t_6;
      __pyx_t_6 = 0;
      __pyx_cur_scope-&gt;__pyx_t_1 = __pyx_t_4;
      __pyx_cur_scope-&gt;__pyx_t_2 = __pyx_t_5;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_9);
      __pyx_cur_scope-&gt;__pyx_t_0 = __pyx_t_9;
      <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
      <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
      /* return from generator, yielding value */
      __pyx_generator-&gt;resume_label = 3;
      return __pyx_r;
      __pyx_L16_resume_from_yield:;
      __pyx_t_4 = __pyx_cur_scope-&gt;__pyx_t_1;
      __pyx_t_5 = __pyx_cur_scope-&gt;__pyx_t_2;
      __pyx_t_9 = __pyx_cur_scope-&gt;__pyx_t_0;
      __pyx_cur_scope-&gt;__pyx_t_0 = 0;
      <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_9);
      if (unlikely(!__pyx_sent_value)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;272: </pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+273:     <span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span></pre>
<pre class='cython code score-4'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_16traverse(PyObject *__pyx_v_self, PyObject *__pyx_v_func); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalNode_16traverse(PyObject *__pyx_v_self, PyObject *__pyx_v_func) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("traverse (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalNode_15traverse(((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_self), ((PyObject *)__pyx_v_func));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalNode_15traverse(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_func) {
  PyObject *__pyx_v_results = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("traverse", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalNode.traverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+274:         <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 274; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+275:         <span class="bp">self</span><span class="o">.</span><span class="n">_traverse</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;__pyx_vtab)-&gt;_traverse(__pyx_v_self, __pyx_v_func, __pyx_v_results);
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+276:         <span class="k">return</span> <span class="n">results</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
  __pyx_r = __pyx_v_results;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;277: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+278:     <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">_traverse</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">func</span><span class="p">,</span> <span class="nb">list</span> <span class="n">results</span><span class="p">):</span></pre>
<pre class='cython code score-6'>static void __pyx_f_6joshua_12intervaltree_12IntervalNode__traverse(struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_self, PyObject *__pyx_v_func, PyObject *__pyx_v_results) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_traverse", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("joshua.intervaltree.IntervalNode._traverse", __pyx_clineno, __pyx_lineno, __pyx_filename, 0, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+279:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cleft</span><span class="o">.</span><span class="n">_traverse</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_self-&gt;cleft != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cleft-&gt;__pyx_vtab)-&gt;_traverse(__pyx_v_self-&gt;cleft, __pyx_v_func, __pyx_v_results);
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-33' onclick='toggleDiv(this)'>+280:         <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></pre>
<pre class='cython code score-33'>  if (unlikely(__pyx_v_results == Py_None)) {
    <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_func);
  __pyx_t_4 = __pyx_v_func; __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, ((PyObject *)__pyx_v_self));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, ((PyObject *)__pyx_v_self));
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_results, __pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+281:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">EmptyNode</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">cright</span><span class="o">.</span><span class="n">_traverse</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_self-&gt;cright != __pyx_v_6joshua_12intervaltree_EmptyNode);
  __pyx_t_1 = (__pyx_t_2 != 0);
  if (__pyx_t_1) {
    ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;cright-&gt;__pyx_vtab)-&gt;_traverse(__pyx_v_self-&gt;cright, __pyx_v_func, __pyx_v_results);
    goto __pyx_L4;
  }
  __pyx_L4:;
</pre><pre class='cython line score-0'>&#xA0;282: </pre>
<pre class='cython line score-16' onclick='toggleDiv(this)'>+283: <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">EmptyNode</span> <span class="o">=</span> <span class="n">IntervalNode</span><span class="p">(</span> <span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">Interval</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">0</span><span class="p">))</span></pre>
<pre class='cython code score-16'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_Interval)), __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalNode)), __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 283; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='refnanny'>__Pyx_XGOTREF</span>(((PyObject *)__pyx_v_6joshua_12intervaltree_EmptyNode));
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_6joshua_12intervaltree_EmptyNode, ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_2));
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;284: </pre>
<pre class='cython line score-0'>&#xA0;285: <span class="c">## ---- Wrappers that retain the old interface -------------------------------</span></pre>
<pre class='cython line score-0'>&#xA0;286: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+287: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">Interval</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_obj_6joshua_12intervaltree_Interval {
  PyObject_HEAD
  int start;
  int end;
  int length;
  PyObject *value;
  PyObject *chrom;
  PyObject *strand;
  PY_LONG_LONG idx;
};

</pre><pre class='cython line score-0'>&#xA0;288:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;289: <span class="sd">    Basic feature, with required integer start and end properties.</span></pre>
<pre class='cython line score-0'>&#xA0;290: <span class="sd">    Also accepts optional strand as +1 or -1 (used for up/downstream queries),</span></pre>
<pre class='cython line score-0'>&#xA0;291: <span class="sd">    a name, and any arbitrary data is sent in on the info keyword argument</span></pre>
<pre class='cython line score-0'>&#xA0;292: </pre>
<pre class='cython line score-0'>&#xA0;293: <span class="sd">    &gt;&gt;&gt; from bx.intervals.intersection import Interval</span></pre>
<pre class='cython line score-0'>&#xA0;294: </pre>
<pre class='cython line score-0'>&#xA0;295: <span class="sd">    &gt;&gt;&gt; f1 = Interval(23, 36)</span></pre>
<pre class='cython line score-0'>&#xA0;296: <span class="sd">    &gt;&gt;&gt; f2 = Interval(34, 48, value={&#39;chr&#39;:12, &#39;anno&#39;:&#39;transposon&#39;})</span></pre>
<pre class='cython line score-0'>&#xA0;297: <span class="sd">    &gt;&gt;&gt; f2</span></pre>
<pre class='cython line score-0'>&#xA0;298: <span class="sd">    Interval(34, 48, value={&#39;anno&#39;: &#39;transposon&#39;, &#39;chr&#39;: 12})</span></pre>
<pre class='cython line score-0'>&#xA0;299: </pre>
<pre class='cython line score-0'>&#xA0;300: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+301:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">int</span> <span class="nf">start</span><span class="p">,</span> <span class="nf">end</span><span class="p">,</span> <span class="nf">length</span></pre>
<pre class='cython code score-30'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5start_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5start_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5start___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_5start___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.start.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_5start_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_5start_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5start_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_5start_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;start = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.start.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_3end_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_3end_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_3end___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_3end___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;end);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.end.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_3end_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_3end_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_3end_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_3end_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;end = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.end.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_6length_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_6length_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_6length___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_6length___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;length);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.length.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_6length_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_6length_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_6length_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_6length_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 301; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;length = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.length.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-18' onclick='toggleDiv(this)'>+302:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">object</span> <span class="nf">value</span><span class="p">,</span> <span class="nf">chrom</span><span class="p">,</span> <span class="nf">strand</span></pre>
<pre class='cython code score-18'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5value_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5value_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5value___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_5value___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;value);
  __pyx_r = __pyx_v_self-&gt;value;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_5value_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_5value_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5value_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_5value_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;value);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;value);
  __pyx_v_self-&gt;value = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_5value_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_5value_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5value_4__del__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_5value_4__del__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;value);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;value);
  __pyx_v_self-&gt;value = Py_None;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5chrom_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5chrom_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5chrom___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_5chrom___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;chrom);
  __pyx_r = __pyx_v_self-&gt;chrom;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_5chrom_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_5chrom_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5chrom_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_5chrom_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;chrom);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;chrom);
  __pyx_v_self-&gt;chrom = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_5chrom_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_5chrom_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_5chrom_4__del__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_5chrom_4__del__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;chrom);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;chrom);
  __pyx_v_self-&gt;chrom = Py_None;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_6strand_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_6strand_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_6strand___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_6strand___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;strand);
  __pyx_r = __pyx_v_self-&gt;strand;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_6strand_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_6strand_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_6strand_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_6strand_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;strand);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;strand);
  __pyx_v_self-&gt;strand = __pyx_v_value;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_6strand_5__del__(PyObject *__pyx_v_self); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_6strand_5__del__(PyObject *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_6strand_4__del__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_6strand_4__del__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__del__", 0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;strand);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;strand);
  __pyx_v_self-&gt;strand = Py_None;

  /* function exit code */
  __pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+303:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">long</span> <span class="kt">long</span> <span class="kt">int</span> <span class="nf">idx</span></pre>
<pre class='cython code score-10'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_3idx_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_3idx_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_3idx___get__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_3idx___get__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_PY_LONG_LONG</span>(__pyx_v_self-&gt;idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.idx.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_3idx_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_3idx_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_3idx_2__set__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval_3idx_2__set__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_PY_LONG_LONG</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 303; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;idx = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.idx.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;304:     <span class="c"># TODO lookup cython statics</span></pre>
<pre class='cython line score-4' onclick='toggleDiv(this)'>+305:     <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">start</span><span class="p">,</span> <span class="nb">int</span> <span class="n">end</span><span class="p">,</span> <span class="nb">object</span> <span class="n">idx</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">object</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">object</span> <span class="n">chrom</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span></pre>
<pre class='cython code score-4'>/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_8Interval_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_8Interval_1__init__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start;
  int __pyx_v_end;
  PyObject *__pyx_v_idx = 0;
  PyObject *__pyx_v_value = 0;
  PyObject *__pyx_v_chrom = 0;
  PyObject *__pyx_v_strand = 0;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__ (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start,&amp;__pyx_n_s_end,&amp;__pyx_n_s_idx,&amp;__pyx_n_s_value,&amp;__pyx_n_s_chrom,&amp;__pyx_n_s_strand,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    values[2] = ((PyObject *)Py_None);
    values[3] = ((PyObject *)Py_None);
    values[4] = ((PyObject *)Py_None);
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_8Interval___init__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, PyObject *__pyx_v_idx, PyObject *__pyx_v_value, PyObject *__pyx_v_chrom, PyObject *__pyx_v_strand) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__init__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-62' onclick='toggleDiv(this)'>+306:                  <span class="nb">object</span> <span class="n">strand</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span></pre>
<pre class='cython code score-62'>    values[5] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_idx);
          if (value) { values[2] = value; kw_args--; }
        }
        case  3:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_value);
          if (value) { values[3] = value; kw_args--; }
        }
        case  4:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_chrom);
          if (value) { values[4] = value; kw_args--; }
        }
        case  5:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_strand);
          if (value) { values[5] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "__init__") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_start = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_idx = values[2];
    __pyx_v_value = values[3];
    __pyx_v_chrom = values[4];
    __pyx_v_strand = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__init__", 0, 2, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 305; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.__init__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return -1;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval___init__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self), __pyx_v_start, __pyx_v_end, __pyx_v_idx, __pyx_v_value, __pyx_v_chrom, __pyx_v_strand);
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+307:         <span class="k">assert</span> <span class="n">start</span> <span class="o">&lt;=</span> <span class="n">end</span><span class="p">,</span> <span class="s">&quot;start must be less than end&quot;</span></pre>
<pre class='cython code score-5'>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!((__pyx_v_start &lt;= __pyx_v_end) != 0))) {
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_kp_s_start_must_be_less_than_end);
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 307; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
  }
  #endif
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+308:         <span class="bp">self</span><span class="o">.</span><span class="n">start</span>  <span class="o">=</span> <span class="n">start</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;start = __pyx_v_start;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+309:         <span class="bp">self</span><span class="o">.</span><span class="n">end</span>   <span class="o">=</span> <span class="n">end</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;end = __pyx_v_end;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+310:         <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;value);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;value);
  __pyx_v_self-&gt;value = __pyx_v_value;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+311:         <span class="bp">self</span><span class="o">.</span><span class="n">chrom</span> <span class="o">=</span> <span class="n">chrom</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_chrom);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_chrom);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;chrom);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;chrom);
  __pyx_v_self-&gt;chrom = __pyx_v_chrom;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+312:         <span class="bp">self</span><span class="o">.</span><span class="n">strand</span> <span class="o">=</span> <span class="n">strand</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strand);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_strand);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;strand);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;strand);
  __pyx_v_self-&gt;strand = __pyx_v_strand;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+313:         <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">start</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;length = (__pyx_v_end - __pyx_v_start);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+314:         <span class="k">if</span> <span class="n">idx</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_idx == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+315:             <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></pre>
<pre class='cython code score-13'>    __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_v_self));
    <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_v_self));
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, ((PyObject *)__pyx_v_self));
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_id, __pyx_t_3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_PY_LONG_LONG</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_self-&gt;idx = __pyx_t_5;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;316:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+317:             <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span></pre>
<pre class='cython code score-2'>    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_PY_LONG_LONG</span>(__pyx_v_idx);<span class='error_goto'> if (unlikely((__pyx_t_5 == (PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 317; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_self-&gt;idx = __pyx_t_5;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;318: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+319:     <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-6'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_3__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_3__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_2__repr__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_2__repr__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  PyObject *__pyx_v_fstr = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fstr);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-14' onclick='toggleDiv(this)'>+320:         <span class="n">fstr</span> <span class="o">=</span> <span class="s">&quot;Interval(</span><span class="si">%d</span><span class="s">, </span><span class="si">%d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span><span class="p">)</span></pre>
<pre class='cython code score-14'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;end);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_2);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyString_Format</span>(__pyx_kp_s_Interval_d_d, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 320; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_fstr = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+321:         <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_self-&gt;value != Py_None);
  __pyx_t_5 = (__pyx_t_4 != 0);
  if (__pyx_t_5) {
</pre><pre class='cython line score-23' onclick='toggleDiv(this)'>+322:             <span class="n">fstr</span> <span class="o">+=</span> <span class="s">&quot;, value=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span></pre>
<pre class='cython code score-23'>    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;value);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;value);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_v_self-&gt;value);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)(&amp;PyString_Type))), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_kp_s_value_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_fstr, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 322; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fstr, __pyx_t_3);
    __pyx_t_3 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+323:         <span class="n">fstr</span> <span class="o">+=</span> <span class="s">&quot;)&quot;</span></pre>
<pre class='cython code score-6'>  __pyx_t_3 = <span class='py_c_api'>PyNumber_InPlaceAdd</span>(__pyx_v_fstr, __pyx_kp_s__3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_v_fstr, __pyx_t_3);
  __pyx_t_3 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+324:         <span class="k">return</span> <span class="n">fstr</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fstr);
  __pyx_r = __pyx_v_fstr;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;325: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+326:     <span class="k">def</span> <span class="nf">__richcmp__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">op</span><span class="p">):</span></pre>
<pre class='cython code score-12'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5__richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_8Interval_5__richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, int __pyx_arg_op) {
  PyObject *__pyx_v_op = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__richcmp__ (wrapper)", 0);
  __pyx_v_op = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_arg_op);<span class='error_goto'> if (unlikely(!__pyx_v_op)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 326; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_op);
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_4__richcmp__(((PyObject *)__pyx_v_self), ((PyObject *)__pyx_v_other), ((PyObject *)__pyx_v_op));
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_op);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_8Interval_4__richcmp__(PyObject *__pyx_v_self, PyObject *__pyx_v_other, PyObject *__pyx_v_op) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__richcmp__", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.Interval.__richcmp__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+327:         <span class="k">if</span> <span class="n">op</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_op, __pyx_int_0, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;328:             <span class="c"># &lt;</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+329:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-30'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_2) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_1 = __pyx_t_5;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L4_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_4, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 329; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L4_bool_binop_done:;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+330:         <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_op, __pyx_int_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 330; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;331:             <span class="c"># &lt;=</span></pre>
<pre class='cython line score-18' onclick='toggleDiv(this)'>+332:             <span class="k">return</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span> <span class="o">&lt;</span> <span class="n">other</span></pre>
<pre class='cython code score-18'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_self, __pyx_v_other, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_2) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_1 = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_self, __pyx_v_other, Py_LT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 332; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L6_bool_binop_done:;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+333:         <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="mf">2</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_op, __pyx_int_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 333; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;334:             <span class="c"># ==</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+335:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-30'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (__pyx_t_2) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_1 = __pyx_t_5;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 335; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L8_bool_binop_done:;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+336:         <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="mf">3</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_op, __pyx_int_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 336; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;337:             <span class="c"># !=</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+338:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-30'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_2) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_1 = __pyx_t_5;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_4, Py_NE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 338; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L10_bool_binop_done:;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+339:         <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="mf">4</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_op, __pyx_int_4, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 339; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;340:             <span class="c"># &gt;</span></pre>
<pre class='cython line score-30' onclick='toggleDiv(this)'>+341:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">end</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-30'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_4, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_2) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      __pyx_t_1 = __pyx_t_5;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_other, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_t_4, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 341; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L12_bool_binop_done:;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+342:         <span class="k">elif</span> <span class="n">op</span> <span class="o">==</span> <span class="mf">5</span><span class="p">:</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_op, __pyx_int_5, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 342; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_2) {
</pre><pre class='cython line score-0'>&#xA0;343:             <span class="c"># &gt;=</span></pre>
<pre class='cython line score-18' onclick='toggleDiv(this)'>+344:             <span class="k">return</span> <span class="bp">self</span> <span class="o">==</span> <span class="n">other</span> <span class="ow">or</span> <span class="bp">self</span> <span class="o">&gt;</span> <span class="n">other</span></pre>
<pre class='cython code score-18'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_self, __pyx_v_other, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_2 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (!__pyx_t_2) {
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    } else {
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      __pyx_t_1 = __pyx_t_3;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_self, __pyx_v_other, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 344; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_1 = __pyx_t_3;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_L14_bool_binop_done:;
    __pyx_r = __pyx_t_1;
    __pyx_t_1 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;345: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+346:     <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0'>/* Python wrapper */
static Py_ssize_t __pyx_pw_6joshua_12intervaltree_8Interval_7__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_6joshua_12intervaltree_8Interval_7__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_8Interval_6__len__(((struct __pyx_obj_6joshua_12intervaltree_Interval *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static Py_ssize_t __pyx_pf_6joshua_12intervaltree_8Interval_6__len__(struct __pyx_obj_6joshua_12intervaltree_Interval *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__len__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+347:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_self-&gt;length;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;348: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+349: <span class="k">cdef</span> <span class="k">class</span> <span class="nf">IntervalTree</span><span class="p">:</span></pre>
<pre class='cython code score-0'>struct __pyx_obj_6joshua_12intervaltree_IntervalTree {
  PyObject_HEAD
  struct __pyx_obj_6joshua_12intervaltree_IntervalNode *root;
  int size;
};

</pre><pre class='cython line score-0'>&#xA0;350:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;351: <span class="sd">    Data structure for performing window intersect queries on a set of </span></pre>
<pre class='cython line score-0'>&#xA0;352: <span class="sd">    of possibly overlapping 1d intervals.</span></pre>
<pre class='cython line score-0'>&#xA0;353: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;354: <span class="sd">    Usage</span></pre>
<pre class='cython line score-0'>&#xA0;355: <span class="sd">    =====</span></pre>
<pre class='cython line score-0'>&#xA0;356: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;357: <span class="sd">    Create an empty IntervalTree</span></pre>
<pre class='cython line score-0'>&#xA0;358: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;359: <span class="sd">    &gt;&gt;&gt; from bx.intervals.intersection import Interval, IntervalTree</span></pre>
<pre class='cython line score-0'>&#xA0;360: <span class="sd">    &gt;&gt;&gt; intersecter = IntervalTree()</span></pre>
<pre class='cython line score-0'>&#xA0;361: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;362: <span class="sd">    An interval is a start and end position and a value (possibly None).</span></pre>
<pre class='cython line score-0'>&#xA0;363: <span class="sd">    You can add any object as an interval:</span></pre>
<pre class='cython line score-0'>&#xA0;364: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;365: <span class="sd">    &gt;&gt;&gt; intersecter.insert( 0, 10, &quot;food&quot; )</span></pre>
<pre class='cython line score-0'>&#xA0;366: <span class="sd">    &gt;&gt;&gt; intersecter.insert( 3, 7, dict(foo=&#39;bar&#39;) )</span></pre>
<pre class='cython line score-0'>&#xA0;367: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;368: <span class="sd">    &gt;&gt;&gt; intersecter.find( 2, 5 )</span></pre>
<pre class='cython line score-0'>&#xA0;369: <span class="sd">    [&#39;food&#39;, {&#39;foo&#39;: &#39;bar&#39;}]</span></pre>
<pre class='cython line score-0'>&#xA0;370: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;371: <span class="sd">    If the object has start and end attributes (like the Interval class) there</span></pre>
<pre class='cython line score-0'>&#xA0;372: <span class="sd">    is are some shortcuts:</span></pre>
<pre class='cython line score-0'>&#xA0;373: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;374: <span class="sd">    &gt;&gt;&gt; intersecter = IntervalTree()</span></pre>
<pre class='cython line score-0'>&#xA0;375: <span class="sd">    &gt;&gt;&gt; intersecter.insert_interval( Interval( 0, 10 ) )</span></pre>
<pre class='cython line score-0'>&#xA0;376: <span class="sd">    &gt;&gt;&gt; intersecter.insert_interval( Interval( 3, 7 ) )</span></pre>
<pre class='cython line score-0'>&#xA0;377: <span class="sd">    &gt;&gt;&gt; intersecter.insert_interval( Interval( 3, 40 ) )</span></pre>
<pre class='cython line score-0'>&#xA0;378: <span class="sd">    &gt;&gt;&gt; intersecter.insert_interval( Interval( 13, 50 ) )</span></pre>
<pre class='cython line score-0'>&#xA0;379: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;380: <span class="sd">    &gt;&gt;&gt; intersecter.find( 30, 50 )</span></pre>
<pre class='cython line score-0'>&#xA0;381: <span class="sd">    [Interval(3, 40), Interval(13, 50)]</span></pre>
<pre class='cython line score-0'>&#xA0;382: <span class="sd">    &gt;&gt;&gt; intersecter.find( 100, 200 )</span></pre>
<pre class='cython line score-0'>&#xA0;383: <span class="sd">    []</span></pre>
<pre class='cython line score-0'>&#xA0;384: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;385: <span class="sd">    Before/after for intervals</span></pre>
<pre class='cython line score-0'>&#xA0;386: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;387: <span class="sd">    &gt;&gt;&gt; intersecter.before_interval( Interval( 10, 20 ) )</span></pre>
<pre class='cython line score-0'>&#xA0;388: <span class="sd">    [Interval(3, 7)]</span></pre>
<pre class='cython line score-0'>&#xA0;389: <span class="sd">    &gt;&gt;&gt; intersecter.before_interval( Interval( 5, 20 ) )</span></pre>
<pre class='cython line score-0'>&#xA0;390: <span class="sd">    []</span></pre>
<pre class='cython line score-0'>&#xA0;391: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;392: <span class="sd">    Upstream/downstream</span></pre>
<pre class='cython line score-0'>&#xA0;393: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;394: <span class="sd">    &gt;&gt;&gt; intersecter.upstream_of_interval(Interval(11, 12))</span></pre>
<pre class='cython line score-0'>&#xA0;395: <span class="sd">    [Interval(0, 10)]</span></pre>
<pre class='cython line score-0'>&#xA0;396: <span class="sd">    &gt;&gt;&gt; intersecter.upstream_of_interval(Interval(11, 12, strand=&quot;-&quot;))</span></pre>
<pre class='cython line score-0'>&#xA0;397: <span class="sd">    [Interval(13, 50)]</span></pre>
<pre class='cython line score-0'>&#xA0;398: </pre>
<pre class='cython line score-0'>&#xA0;399: <span class="sd">    &gt;&gt;&gt; intersecter.upstream_of_interval(Interval(1, 2, strand=&quot;-&quot;), num_intervals=3)</span></pre>
<pre class='cython line score-0'>&#xA0;400: <span class="sd">    [Interval(3, 7), Interval(3, 40), Interval(13, 50)]</span></pre>
<pre class='cython line score-0'>&#xA0;401: </pre>
<pre class='cython line score-0'>&#xA0;402: <span class="sd">    </span></pre>
<pre class='cython line score-0'>&#xA0;403: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;404: </pre>
<pre class='cython line score-0'>&#xA0;405:     <span class="k">cdef</span> <span class="kt">IntervalNode</span> <span class="nf">root</span></pre>
<pre class='cython line score-10' onclick='toggleDiv(this)'>+406:     <span class="k">cdef</span> <span class="kr">public</span> <span class="kt">int</span> <span class="nf">size</span></pre>
<pre class='cython code score-10'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_4size_1__get__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_4size_1__get__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_4size___get__(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_4size___get__(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__get__", 0);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_self-&gt;size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.size.__get__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalTree_4size_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalTree_4size_3__set__(PyObject *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_4size_2__set__(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), ((PyObject *)__pyx_v_value));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalTree_4size_2__set__(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_value) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__set__", 0);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_value);<span class='error_goto'> if (unlikely((__pyx_t_1 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 406; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_self-&gt;size = __pyx_t_1;

  /* function exit code */
  __pyx_r = 0;
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.size.__set__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = -1;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;407: </pre>
<pre class='cython line score-12' onclick='toggleDiv(this)'>+408:     <span class="k">def</span> <span class="nf">__cinit__</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span></pre>
<pre class='cython code score-12'>/* Python wrapper */
static int __pyx_pw_6joshua_12intervaltree_12IntervalTree_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static int __pyx_pw_6joshua_12intervaltree_12IntervalTree_1__cinit__(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__ (wrapper)", 0);
  if (unlikely(<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) &gt; 0)) {
    <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("__cinit__", 1, 0, 0, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); return -1;}
  if (unlikely(__pyx_kwds) &amp;&amp; unlikely(<span class='py_c_api'>PyDict_Size</span>(__pyx_kwds) &gt; 0) &amp;&amp; unlikely(!<span class='pyx_c_api'>__Pyx_CheckKeywordStrings</span>(__pyx_kwds, "__cinit__", 0))) return -1;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree___cinit__(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static int __pyx_pf_6joshua_12intervaltree_12IntervalTree___cinit__(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self) {
  CYTHON_UNUSED PyObject *__pyx_v_root = NULL;
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__cinit__", 0);
/* … */
  /* function exit code */
  __pyx_r = 0;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_root);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+409:         <span class="n">root</span> <span class="o">=</span> <span class="bp">None</span></pre>
<pre class='cython code score-1'>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  __pyx_v_root = Py_None;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+410:         <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;size = 0;
</pre><pre class='cython line score-0'>&#xA0;411: </pre>
<pre class='cython line score-0'>&#xA0;412:     <span class="c"># ---- Position based interfaces -----------------------------------------</span></pre>
<pre class='cython line score-0'>&#xA0;413: </pre>
<pre class='cython line score-47' onclick='toggleDiv(this)'>+414:     <span class="k">def</span> <span class="nf">insert</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">int</span> <span class="n">start</span><span class="p">,</span> <span class="nb">int</span> <span class="n">end</span><span class="p">,</span> <span class="nb">object</span> <span class="n">value</span><span class="o">=</span><span class="bp">None</span> <span class="p">):</span></pre>
<pre class='cython code score-47'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_3insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_2insert[] = "\n        Insert the interval [start,end) associated with value `value`.\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_3insert(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_start;
  int __pyx_v_end;
  PyObject *__pyx_v_value = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start,&amp;__pyx_n_s_end,&amp;__pyx_n_s_value,0};
    PyObject* values[3] = {0,0,0};
    values[2] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 0, 2, 3, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_value);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "insert") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_start = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]);<span class='error_goto'> if (unlikely((__pyx_v_start == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_end = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_end == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    __pyx_v_value = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("insert", 0, 2, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 414; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_2insert(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_start, __pyx_v_end, __pyx_v_value);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_2insert(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, int __pyx_v_start, int __pyx_v_end, PyObject *__pyx_v_value) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.insert", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;415:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;416: <span class="sd">        Insert the interval [start,end) associated with value `value`.</span></pre>
<pre class='cython line score-0'>&#xA0;417: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+418:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-17' onclick='toggleDiv(this)'>+419:             <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">IntervalNode</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span> <span class="p">)</span></pre>
<pre class='cython code score-17'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_value);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_value);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2, __pyx_v_value);
    __pyx_t_3 = 0;
    __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalNode)), __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 419; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;root);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;root));
    __pyx_v_self-&gt;root = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_4);
    __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;420:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-1' onclick='toggleDiv(this)'>+421:             <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">value</span> <span class="p">)</span></pre>
<pre class='cython code score-1'>    __pyx_t_4 = ((PyObject *)((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;insert(__pyx_v_self-&gt;root, __pyx_v_start, __pyx_v_end, __pyx_v_value, 0));<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 421; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;root);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_v_self-&gt;root));
    __pyx_v_self-&gt;root = ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_t_4);
    __pyx_t_4 = 0;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+422:         <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>  __pyx_v_self-&gt;size = (__pyx_v_self-&gt;size + 1);
</pre><pre class='cython line score-0'>&#xA0;423: </pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+424:     <span class="n">add</span> <span class="o">=</span> <span class="n">insert</span></pre>
<pre class='cython code score-13'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetNameInClass</span>((PyObject *)__pyx_ptype_6joshua_12intervaltree_IntervalTree, __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6joshua_12intervaltree_IntervalTree-&gt;tp_dict, __pyx_n_s_add, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 424; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6joshua_12intervaltree_IntervalTree);
</pre><pre class='cython line score-0'>&#xA0;425: </pre>
<pre class='cython line score-36' onclick='toggleDiv(this)'>+426:     <span class="k">def</span> <span class="nf">find</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="p">):</span></pre>
<pre class='cython code score-36'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_5find(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_4find[] = "\n        Return a sorted list of all intervals overlapping [start,end).\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_5find(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_start = 0;
  PyObject *__pyx_v_end = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_start,&amp;__pyx_n_s_end,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_start)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_end)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find", 1, 2, 2, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "find") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_start = values[0];
    __pyx_v_end = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("find", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 426; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.find", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_4find(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_start, __pyx_v_end);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_4find(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_start, PyObject *__pyx_v_end) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("find", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.find", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;427:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;428: <span class="sd">        Return a sorted list of all intervals overlapping [start,end).</span></pre>
<pre class='cython line score-0'>&#xA0;429: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+430:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+431:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 431; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+432:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="p">)</span></pre>
<pre class='cython code score-27'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;root), __pyx_n_s_find);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_start);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_start);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_v_start);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_end);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_end);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_v_end);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 432; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;433: </pre>
<pre class='cython line score-38' onclick='toggleDiv(this)'>+434:     <span class="k">def</span> <span class="nf">before</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">num_intervals</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span> <span class="p">):</span></pre>
<pre class='cython code score-38'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_7before(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_6before[] = "\n        Find `num_intervals` intervals that lie before `position` and are no\n        further than `max_dist` positions away\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_7before(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_position = 0;
  PyObject *__pyx_v_num_intervals = 0;
  PyObject *__pyx_v_max_dist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("before (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position,&amp;__pyx_n_s_num_intervals,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    values[2] = ((PyObject *)__pyx_int_2500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_position)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_intervals);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "before") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_position = values[0];
    __pyx_v_num_intervals = values[1];
    __pyx_v_max_dist = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("before", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 434; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.before", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_6before(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_position, __pyx_v_num_intervals, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_6before(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_position, PyObject *__pyx_v_num_intervals, PyObject *__pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("before", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.before", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;435:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;436: <span class="sd">        Find `num_intervals` intervals that lie before `position` and are no</span></pre>
<pre class='cython line score-0'>&#xA0;437: <span class="sd">        further than `max_dist` positions away</span></pre>
<pre class='cython line score-0'>&#xA0;438: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+439:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+440:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 440; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+441:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">(</span> <span class="n">position</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-5'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6.__pyx_n = 2;
  __pyx_t_6.n = __pyx_t_4;
  __pyx_t_6.max_dist = __pyx_t_5;
  __pyx_t_3 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;left(__pyx_v_self-&gt;root, __pyx_v_position, 0, &amp;__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 441; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;442: </pre>
<pre class='cython line score-38' onclick='toggleDiv(this)'>+443:     <span class="k">def</span> <span class="nf">after</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">num_intervals</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span> <span class="p">):</span></pre>
<pre class='cython code score-38'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_9after(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_8after[] = "\n        Find `num_intervals` intervals that lie after `position` and are no\n        further than `max_dist` positions away\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_9after(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_position = 0;
  PyObject *__pyx_v_num_intervals = 0;
  PyObject *__pyx_v_max_dist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("after (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_position,&amp;__pyx_n_s_num_intervals,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    values[2] = ((PyObject *)__pyx_int_2500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_position)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_intervals);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "after") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_position = values[0];
    __pyx_v_num_intervals = values[1];
    __pyx_v_max_dist = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("after", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 443; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.after", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_8after(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_position, __pyx_v_num_intervals, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_8after(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_position, PyObject *__pyx_v_num_intervals, PyObject *__pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("after", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.after", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;444:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;445: <span class="sd">        Find `num_intervals` intervals that lie after `position` and are no</span></pre>
<pre class='cython line score-0'>&#xA0;446: <span class="sd">        further than `max_dist` positions away</span></pre>
<pre class='cython line score-0'>&#xA0;447: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+448:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+449:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 449; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+450:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">(</span> <span class="n">position</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-5'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_6.__pyx_n = 2;
  __pyx_t_6.n = __pyx_t_4;
  __pyx_t_6.max_dist = __pyx_t_5;
  __pyx_t_3 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;right(__pyx_v_self-&gt;root, __pyx_v_position, 0, &amp;__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 450; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;451: </pre>
<pre class='cython line score-0'>&#xA0;452:     <span class="c"># ---- Interval-like object based interfaces -----------------------------</span></pre>
<pre class='cython line score-0'>&#xA0;453: </pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+454:     <span class="k">def</span> <span class="nf">insert_interval</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">interval</span> <span class="p">):</span></pre>
<pre class='cython code score-9'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_11insert_interval(PyObject *__pyx_v_self, PyObject *__pyx_v_interval); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_10insert_interval[] = "\n        Insert an \"interval\" like object (one with at least start and end\n        attributes)\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_11insert_interval(PyObject *__pyx_v_self, PyObject *__pyx_v_interval) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert_interval (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_10insert_interval(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), ((PyObject *)__pyx_v_interval));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_10insert_interval(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_interval) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("insert_interval", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.insert_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;455:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;456: <span class="sd">        Insert an &quot;interval&quot; like object (one with at least start and end</span></pre>
<pre class='cython line score-0'>&#xA0;457: <span class="sd">        attributes)</span></pre>
<pre class='cython line score-0'>&#xA0;458: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-31' onclick='toggleDiv(this)'>+459:         <span class="bp">self</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">interval</span> <span class="p">)</span></pre>
<pre class='cython code score-31'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_insert);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (__pyx_t_5) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_interval);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_interval);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_v_interval);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 459; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;460: </pre>
<pre class='cython line score-13' onclick='toggleDiv(this)'>+461:     <span class="n">add_interval</span> <span class="o">=</span> <span class="n">insert_interval</span></pre>
<pre class='cython code score-13'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetNameInClass</span>((PyObject *)__pyx_ptype_6joshua_12intervaltree_IntervalTree, __pyx_n_s_insert_interval);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>((PyObject *)__pyx_ptype_6joshua_12intervaltree_IntervalTree-&gt;tp_dict, __pyx_n_s_add_interval, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 461; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='py_c_api'>PyType_Modified</span>(__pyx_ptype_6joshua_12intervaltree_IntervalTree);
</pre><pre class='cython line score-0'>&#xA0;462: </pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+463:     <span class="k">def</span> <span class="nf">before_interval</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">num_intervals</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span> <span class="p">):</span></pre>
<pre class='cython code score-39'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_13before_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_12before_interval[] = "\n        Find `num_intervals` intervals that lie completely before `interval`\n        and are no further than `max_dist` positions away\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_13before_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_interval = 0;
  PyObject *__pyx_v_num_intervals = 0;
  PyObject *__pyx_v_max_dist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("before_interval (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_interval,&amp;__pyx_n_s_num_intervals,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    values[2] = ((PyObject *)__pyx_int_2500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_interval)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_intervals);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "before_interval") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_interval = values[0];
    __pyx_v_num_intervals = values[1];
    __pyx_v_max_dist = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("before_interval", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 463; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.before_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_12before_interval(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_interval, __pyx_v_num_intervals, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_12before_interval(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_interval, PyObject *__pyx_v_num_intervals, PyObject *__pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("before_interval", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.before_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;464:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;465: <span class="sd">        Find `num_intervals` intervals that lie completely before `interval`</span></pre>
<pre class='cython line score-0'>&#xA0;466: <span class="sd">        and are no further than `max_dist` positions away</span></pre>
<pre class='cython line score-0'>&#xA0;467: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+468:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+469:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+470:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7.__pyx_n = 2;
  __pyx_t_7.n = __pyx_t_4;
  __pyx_t_7.max_dist = __pyx_t_5;
  __pyx_t_6 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;left(__pyx_v_self-&gt;root, __pyx_t_3, 0, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 470; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;471: </pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+472:     <span class="k">def</span> <span class="nf">after_interval</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">num_intervals</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span> <span class="p">):</span></pre>
<pre class='cython code score-39'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_15after_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_14after_interval[] = "\n        Find `num_intervals` intervals that lie completely after `interval` and\n        are no further than `max_dist` positions away\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_15after_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_interval = 0;
  PyObject *__pyx_v_num_intervals = 0;
  PyObject *__pyx_v_max_dist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("after_interval (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_interval,&amp;__pyx_n_s_num_intervals,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    values[2] = ((PyObject *)__pyx_int_2500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_interval)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_intervals);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "after_interval") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_interval = values[0];
    __pyx_v_num_intervals = values[1];
    __pyx_v_max_dist = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("after_interval", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 472; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.after_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_14after_interval(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_interval, __pyx_v_num_intervals, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_14after_interval(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_interval, PyObject *__pyx_v_num_intervals, PyObject *__pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("after_interval", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.after_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;473:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;474: <span class="sd">        Find `num_intervals` intervals that lie completely after `interval` and</span></pre>
<pre class='cython line score-0'>&#xA0;475: <span class="sd">        are no further than `max_dist` positions away</span></pre>
<pre class='cython line score-0'>&#xA0;476: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+477:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+478:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+479:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_4 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_7.__pyx_n = 2;
  __pyx_t_7.n = __pyx_t_4;
  __pyx_t_7.max_dist = __pyx_t_5;
  __pyx_t_6 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;right(__pyx_v_self-&gt;root, __pyx_t_3, 0, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;480: </pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+481:     <span class="k">def</span> <span class="nf">upstream_of_interval</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">num_intervals</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span> <span class="p">):</span></pre>
<pre class='cython code score-39'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_17upstream_of_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_16upstream_of_interval[] = "\n        Find `num_intervals` intervals that lie completely upstream of\n        `interval` and are no further than `max_dist` positions away\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_17upstream_of_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_interval = 0;
  PyObject *__pyx_v_num_intervals = 0;
  PyObject *__pyx_v_max_dist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("upstream_of_interval (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_interval,&amp;__pyx_n_s_num_intervals,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    values[2] = ((PyObject *)__pyx_int_2500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_interval)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_intervals);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "upstream_of_interval") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_interval = values[0];
    __pyx_v_num_intervals = values[1];
    __pyx_v_max_dist = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("upstream_of_interval", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 481; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.upstream_of_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_16upstream_of_interval(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_interval, __pyx_v_num_intervals, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_16upstream_of_interval(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_interval, PyObject *__pyx_v_num_intervals, PyObject *__pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("upstream_of_interval", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.upstream_of_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;482:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;483: <span class="sd">        Find `num_intervals` intervals that lie completely upstream of</span></pre>
<pre class='cython line score-0'>&#xA0;484: <span class="sd">        `interval` and are no further than `max_dist` positions away</span></pre>
<pre class='cython line score-0'>&#xA0;485: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+486:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+487:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 487; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+488:         <span class="k">if</span> <span class="n">interval</span><span class="o">.</span><span class="n">strand</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">interval</span><span class="o">.</span><span class="n">strand</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-16'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_strand);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_neg_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_strand);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_t_4, __pyx_kp_s__4, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 488; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2 = __pyx_t_1;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_2) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+489:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7.__pyx_n = 2;
    __pyx_t_7.n = __pyx_t_5;
    __pyx_t_7.max_dist = __pyx_t_6;
    __pyx_t_3 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;right(__pyx_v_self-&gt;root, __pyx_t_4, 0, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 489; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;490:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+491:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8.__pyx_n = 2;
    __pyx_t_8.n = __pyx_t_6;
    __pyx_t_8.max_dist = __pyx_t_5;
    __pyx_t_4 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;left(__pyx_v_self-&gt;root, __pyx_t_3, 0, &amp;__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 491; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;492: </pre>
<pre class='cython line score-39' onclick='toggleDiv(this)'>+493:     <span class="k">def</span> <span class="nf">downstream_of_interval</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">interval</span><span class="p">,</span> <span class="n">num_intervals</span><span class="o">=</span><span class="mf">1</span><span class="p">,</span> <span class="n">max_dist</span><span class="o">=</span><span class="mf">2500</span> <span class="p">):</span></pre>
<pre class='cython code score-39'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_19downstream_of_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_18downstream_of_interval[] = "\n        Find `num_intervals` intervals that lie completely downstream of\n        `interval` and are no further than `max_dist` positions away\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_19downstream_of_interval(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_interval = 0;
  PyObject *__pyx_v_num_intervals = 0;
  PyObject *__pyx_v_max_dist = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("downstream_of_interval (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_interval,&amp;__pyx_n_s_num_intervals,&amp;__pyx_n_s_max_dist,0};
    PyObject* values[3] = {0,0,0};
    values[1] = ((PyObject *)__pyx_int_1);
    values[2] = ((PyObject *)__pyx_int_2500);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_interval)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_num_intervals);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_max_dist);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "downstream_of_interval") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_interval = values[0];
    __pyx_v_num_intervals = values[1];
    __pyx_v_max_dist = values[2];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("downstream_of_interval", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 493; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.downstream_of_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_18downstream_of_interval(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_interval, __pyx_v_num_intervals, __pyx_v_max_dist);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_18downstream_of_interval(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_interval, PyObject *__pyx_v_num_intervals, PyObject *__pyx_v_max_dist) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("downstream_of_interval", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.downstream_of_interval", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;494:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;495: <span class="sd">        Find `num_intervals` intervals that lie completely downstream of</span></pre>
<pre class='cython line score-0'>&#xA0;496: <span class="sd">        `interval` and are no further than `max_dist` positions away</span></pre>
<pre class='cython line score-0'>&#xA0;497: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+498:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+499:             <span class="k">return</span> <span class="p">[]</span></pre>
<pre class='cython code score-6'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 499; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-16' onclick='toggleDiv(this)'>+500:         <span class="k">if</span> <span class="n">interval</span><span class="o">.</span><span class="n">strand</span> <span class="o">==</span> <span class="o">-</span><span class="mf">1</span> <span class="ow">or</span> <span class="n">interval</span><span class="o">.</span><span class="n">strand</span> <span class="o">==</span> <span class="s">&quot;-&quot;</span><span class="p">:</span></pre>
<pre class='cython code score-16'>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_strand);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_int_neg_1, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (!__pyx_t_1) {
  } else {
    __pyx_t_2 = __pyx_t_1;
    goto __pyx_L5_bool_binop_done;
  }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_strand);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_1 = (<span class='pyx_c_api'>__Pyx_PyString_Equals</span>(__pyx_t_4, __pyx_kp_s__4, Py_EQ));<span class='error_goto'> if (unlikely(__pyx_t_1 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 500; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_t_2 = __pyx_t_1;
  __pyx_L5_bool_binop_done:;
  if (__pyx_t_2) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+501:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">left</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_7.__pyx_n = 2;
    __pyx_t_7.n = __pyx_t_5;
    __pyx_t_7.max_dist = __pyx_t_6;
    __pyx_t_3 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;left(__pyx_v_self-&gt;root, __pyx_t_4, 0, &amp;__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 501; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_r = __pyx_t_3;
    __pyx_t_3 = 0;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;502:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+503:             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">right</span><span class="p">(</span> <span class="n">interval</span><span class="o">.</span><span class="n">end</span><span class="p">,</span> <span class="n">num_intervals</span><span class="p">,</span> <span class="n">max_dist</span> <span class="p">)</span></pre>
<pre class='cython code score-8'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_interval, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_num_intervals);<span class='error_goto'> if (unlikely((__pyx_t_6 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_max_dist);<span class='error_goto'> if (unlikely((__pyx_t_5 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_t_8.__pyx_n = 2;
    __pyx_t_8.n = __pyx_t_6;
    __pyx_t_8.max_dist = __pyx_t_5;
    __pyx_t_4 = ((struct __pyx_vtabstruct_6joshua_12intervaltree_IntervalNode *)__pyx_v_self-&gt;root-&gt;__pyx_vtab)-&gt;right(__pyx_v_self-&gt;root, __pyx_t_3, 0, &amp;__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_r = __pyx_t_4;
    __pyx_t_4 = 0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;504: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+505:     <span class="k">def</span> <span class="nf">traverse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">):</span></pre>
<pre class='cython code score-6'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_21traverse(PyObject *__pyx_v_self, PyObject *__pyx_v_fn); /*proto*/
static char __pyx_doc_6joshua_12intervaltree_12IntervalTree_20traverse[] = "\n        call fn for each element in the tree\n        ";
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_21traverse(PyObject *__pyx_v_self, PyObject *__pyx_v_fn) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("traverse (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_20traverse(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), ((PyObject *)__pyx_v_fn));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_20traverse(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_fn) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("traverse", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.traverse", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;506:         <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;507: <span class="sd">        call fn for each element in the tree</span></pre>
<pre class='cython line score-0'>&#xA0;508: <span class="sd">        &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+509:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+510:             <span class="k">return</span> <span class="bp">None</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    __pyx_r = Py_None;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+511:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span></pre>
<pre class='cython code score-27'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self-&gt;root), __pyx_n_s_traverse);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_5) {
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_fn);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_5); __pyx_t_5 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fn);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fn);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_fn);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_r = __pyx_t_3;
  __pyx_t_3 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;512: </pre>
<pre class='cython line score-54' onclick='toggleDiv(this)'>+513:     <span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">other</span><span class="p">,</span> <span class="nb">float</span> <span class="n">self_cutoff</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="nb">float</span> <span class="n">other_cutoff</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span></pre>
<pre class='cython code score-54'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_23intersect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_23intersect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_other = 0;
  float __pyx_v_self_cutoff;
  float __pyx_v_other_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_other,&amp;__pyx_n_s_self_cutoff,&amp;__pyx_n_s_other_cutoff,0};
    PyObject* values[3] = {0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_other)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_self_cutoff);
          if (value) { values[1] = value; kw_args--; }
        }
        case  2:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_other_cutoff);
          if (value) { values[2] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "intersect") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_other = values[0];
    if (values[1]) {
      __pyx_v_self_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_self_cutoff == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_self_cutoff = ((float)0.9);
    }
    if (values[2]) {
      __pyx_v_other_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[2]);<span class='error_goto'> if (unlikely((__pyx_v_other_cutoff == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_other_cutoff = ((float)0.1);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("intersect", 0, 1, 3, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 513; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_22intersect(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_other, __pyx_v_self_cutoff, __pyx_v_other_cutoff);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_22intersect(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_other, float __pyx_v_self_cutoff, float __pyx_v_other_cutoff) {
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_1_intersect *__pyx_cur_scope;
  PyObject *__pyx_v_overlap_fn = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("intersect", 0);
  __pyx_cur_scope = (struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_1_intersect *)__pyx_tp_new_6joshua_12intervaltree___pyx_scope_struct_1_intersect(__pyx_ptype_6joshua_12intervaltree___pyx_scope_struct_1_intersect, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  __pyx_cur_scope-&gt;__pyx_v_other = __pyx_v_other;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_other);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_other);
  __pyx_cur_scope-&gt;__pyx_v_self_cutoff = __pyx_v_self_cutoff;
  __pyx_cur_scope-&gt;__pyx_v_other_cutoff = __pyx_v_other_cutoff;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_overlap_fn);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_1_intersect {
  PyObject_HEAD
  PyObject *__pyx_v_other;
  float __pyx_v_other_cutoff;
  PyObject *__pyx_v_overlaps;
  float __pyx_v_self_cutoff;
};

</pre><pre class='cython line score-0'>&#xA0;514: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+515:         <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">IntervalTree</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)Py_TYPE(__pyx_cur_scope-&gt;__pyx_v_other)) != ((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalTree)));
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-23' onclick='toggleDiv(this)'>+516:             <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Expected IntervalTree, go {t}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span></pre>
<pre class='cython code score-23'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Expected_IntervalTree_go_t, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+517:                             <span class="n">t</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span></pre>
<pre class='cython code score-5'>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, ((PyObject *)Py_TYPE(__pyx_cur_scope-&gt;__pyx_v_other))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;518: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+519:         <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">overlaps</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 519; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_cur_scope-&gt;__pyx_v_overlaps = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+520:         <span class="k">def</span> <span class="nf">overlap_fn</span><span class="p">(</span><span class="n">IntervalNode</span> <span class="n">node</span><span class="p">):</span></pre>
<pre class='cython code score-28'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_9intersect_1overlap_fn(PyObject *__pyx_self, PyObject *__pyx_v_node); /*proto*/
static PyMethodDef __pyx_mdef_6joshua_12intervaltree_12IntervalTree_9intersect_1overlap_fn = {"overlap_fn", (PyCFunction)__pyx_pw_6joshua_12intervaltree_12IntervalTree_9intersect_1overlap_fn, METH_O, 0};
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_9intersect_1overlap_fn(PyObject *__pyx_self, PyObject *__pyx_v_node) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("overlap_fn (wrapper)", 0);
  if (unlikely(!<span class='pyx_c_api'>__Pyx_ArgTypeTest</span>(((PyObject *)__pyx_v_node), __pyx_ptype_6joshua_12intervaltree_IntervalNode, 1, "node", 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_9intersect_overlap_fn(__pyx_self, ((struct __pyx_obj_6joshua_12intervaltree_IntervalNode *)__pyx_v_node));
  CYTHON_UNUSED int __pyx_lineno = 0;
  CYTHON_UNUSED const char *__pyx_filename = NULL;
  CYTHON_UNUSED int __pyx_clineno = 0;

  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_9intersect_overlap_fn(PyObject *__pyx_self, struct __pyx_obj_6joshua_12intervaltree_IntervalNode *__pyx_v_node) {
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_1_intersect *__pyx_cur_scope;
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_1_intersect *__pyx_outer_scope;
  PyObject *__pyx_v_iv = 0;
  float __pyx_v_ov_len;
  int __pyx_v_start;
  int __pyx_v_end;
  PyObject *__pyx_v_results = 0;
  PyObject *__pyx_v_ov = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("overlap_fn", 0);
  __pyx_outer_scope = (struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_1_intersect *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.intersect.overlap_fn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_iv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ov);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_node, __pyx_n_s_iv, __pyx_n_s_ov_len, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_results, __pyx_n_s_ov);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6joshua_12intervaltree_12IntervalTree_9intersect_1overlap_fn, 0, __pyx_n_s_intersect_locals_overlap_fn, ((PyObject*)__pyx_cur_scope), __pyx_n_s_joshua_intervaltree, __pyx_d, ((PyObject *)__pyx_codeobj__6));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_v_overlap_fn = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_codeobj__6 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 7, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__5, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_camille_w_joshua_joshua_in, __pyx_n_s_overlap_fn, 520, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 520; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+521:             <span class="k">cdef</span> <span class="kt">object</span> <span class="nf">iv</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">interval</span></pre>
<pre class='cython code score-1'>  __pyx_t_1 = __pyx_v_node-&gt;interval;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_iv = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;522:             <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">ov_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+523:             <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">start</span> <span class="o">=</span> <span class="n">iv</span><span class="o">.</span><span class="n">start</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iv, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 523; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_start = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+524:             <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">end</span> <span class="o">=</span> <span class="n">iv</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iv, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_end = __pyx_t_2;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+525:             <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">results</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></pre>
<pre class='cython code score-40'>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_other)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("other"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_other, __pyx_n_s_find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_6) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+526:             <span class="k">if</span> <span class="n">results</span><span class="p">:</span></pre>
<pre class='cython code score-1'>  __pyx_t_9 = (__pyx_v_results != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_results) != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-12' onclick='toggleDiv(this)'>+527:                 <span class="k">for</span> <span class="n">ov</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span></pre>
<pre class='cython code score-12'>    if (unlikely(__pyx_v_results == Py_None)) {
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_TypeError, "'NoneType' object is not iterable");
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_1 = __pyx_v_results; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7 = 0;
    for (;;) {
      if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_1)) break;
      #if CYTHON_COMPILING_IN_CPYTHON
      __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_1, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_7++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_1, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 527; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      #endif
      <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ov, __pyx_t_3);
      __pyx_t_3 = 0;
/* … */
    }
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-12' onclick='toggleDiv(this)'>+528:                     <span class="n">ov_len</span> <span class="o">=</span> <span class="n">calc_bases_overlapped_single</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span></pre>
<pre class='cython code score-12'>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calc_bases_overlapped_single);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
      __pyx_t_14 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_3);<span class='error_goto'> if (unlikely((__pyx_t_14 == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_v_ov_len = __pyx_t_14;
</pre><pre class='cython line score-28' onclick='toggleDiv(this)'>+529:                                                           <span class="n">ov</span><span class="o">.</span><span class="n">start</span><span class="p">,</span> <span class="n">ov</span><span class="o">.</span><span class="n">end</span><span class="p">)</span></pre>
<pre class='cython code score-28'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ov, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ov, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 529; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
      __pyx_t_11 = NULL;
      __pyx_t_12 = 0;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_11)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
          __pyx_t_12 = 1;
        }
      }
      __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
      if (__pyx_t_11) {
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
      }
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_12, __pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_12, __pyx_t_4);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_12, __pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3+__pyx_t_12, __pyx_t_10);
      __pyx_t_5 = 0;
      __pyx_t_4 = 0;
      __pyx_t_6 = 0;
      __pyx_t_10 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 528; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+530:                     <span class="k">if</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ov_len</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">self_cutoff</span> \</pre>
<pre class='cython code score-10'>      __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_iv);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (unlikely(__pyx_t_12 == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
/* … */
      __pyx_t_15 = (((((double)__pyx_v_ov_len) / __pyx_t_12) &gt;= __pyx_cur_scope-&gt;__pyx_v_self_cutoff) != 0);
      if (__pyx_t_15) {
      } else {
        __pyx_t_9 = __pyx_t_15;
        goto __pyx_L7_bool_binop_done;
      }
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+531:                         <span class="ow">and</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ov_len</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ov</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">other_cutoff</span><span class="p">:</span></pre>
<pre class='cython code score-10'>      __pyx_t_12 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_ov);<span class='error_goto'> if (unlikely(__pyx_t_12 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      if (unlikely(__pyx_t_12 == 0)) {
        #ifdef WITH_THREAD
        PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
        #endif
        <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
        #ifdef WITH_THREAD
        PyGILState_Release(__pyx_gilstate_save);
        #endif
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 531; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_15 = (((((double)__pyx_v_ov_len) / __pyx_t_12) &gt;= __pyx_cur_scope-&gt;__pyx_v_other_cutoff) != 0);
      __pyx_t_9 = __pyx_t_15;
      __pyx_L7_bool_binop_done:;
      if (__pyx_t_9) {
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+532:                         <span class="n">overlaps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iv</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">ov</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">ov_len</span><span class="p">))</span></pre>
<pre class='cython code score-27'>        if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_overlaps)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("overlaps"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
        if (unlikely(__pyx_cur_scope-&gt;__pyx_v_overlaps == Py_None)) {
          <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
          <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iv, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_ov, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_13 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ov_len);<span class='error_goto'> if (unlikely(!__pyx_t_13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
        __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_13);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_13);
        __pyx_t_3 = 0;
        __pyx_t_8 = 0;
        __pyx_t_13 = 0;
        __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_cur_scope-&gt;__pyx_v_overlaps, __pyx_t_10);<span class='error_goto'> if (unlikely(__pyx_t_16 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 532; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        goto __pyx_L6;
      }
      __pyx_L6:;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+533:         <span class="bp">self</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">overlap_fn</span><span class="p">)</span></pre>
<pre class='cython code score-27'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_traverse);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_overlap_fn);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_overlap_fn);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_overlap_fn);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_overlap_fn);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 533; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+534:         <span class="k">return</span> <span class="n">overlaps</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_overlaps);
  __pyx_r = __pyx_cur_scope-&gt;__pyx_v_overlaps;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;535: </pre>
<pre class='cython line score-42' onclick='toggleDiv(this)'>+536:     <span class="k">def</span> <span class="nf">coverage_intersect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">object</span> <span class="n">other</span><span class="p">,</span> <span class="nb">float</span> <span class="n">cutoff</span><span class="o">=</span><span class="mf">0.9</span><span class="p">):</span></pre>
<pre class='cython code score-42'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_25coverage_intersect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_25coverage_intersect(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_other = 0;
  float __pyx_v_cutoff;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coverage_intersect (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_other,&amp;__pyx_n_s_cutoff,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_other)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_cutoff);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "coverage_intersect") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_other = values[0];
    if (values[1]) {
      __pyx_v_cutoff = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(values[1]);<span class='error_goto'> if (unlikely((__pyx_v_cutoff == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
    } else {
      __pyx_v_cutoff = ((float)0.9);
    }
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("coverage_intersect", 0, 1, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 536; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.coverage_intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_24coverage_intersect(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self), __pyx_v_other, __pyx_v_cutoff);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_24coverage_intersect(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self, PyObject *__pyx_v_other, float __pyx_v_cutoff) {
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect *__pyx_cur_scope;
  PyObject *__pyx_v_overlap_fn = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("coverage_intersect", 0);
  __pyx_cur_scope = (struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect *)__pyx_tp_new_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect(__pyx_ptype_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  __pyx_cur_scope-&gt;__pyx_v_other = __pyx_v_other;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_other);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_other);
  __pyx_cur_scope-&gt;__pyx_v_cutoff = __pyx_v_cutoff;
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.coverage_intersect", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_overlap_fn);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect {
  PyObject_HEAD
  float __pyx_v_cutoff;
  PyObject *__pyx_v_other;
  PyObject *__pyx_v_overlaps;
};

</pre><pre class='cython line score-0'>&#xA0;537: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+538:         <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">IntervalTree</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)Py_TYPE(__pyx_cur_scope-&gt;__pyx_v_other)) != ((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalTree)));
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-23' onclick='toggleDiv(this)'>+539:             <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;Expected IntervalTree, go {t}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span></pre>
<pre class='cython code score-23'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_kp_s_Expected_IntervalTree_go_t, __pyx_n_s_format);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_4 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
/* … */
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_empty_tuple, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_4, 0, __pyx_t_5);
    __pyx_t_5 = 0;
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_TypeError, __pyx_t_4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_5, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+540:                             <span class="n">t</span><span class="o">=</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span></pre>
<pre class='cython code score-5'>    if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_4, __pyx_n_s_t, ((PyObject *)Py_TYPE(__pyx_cur_scope-&gt;__pyx_v_other))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 539; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;541: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+542:         <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">overlaps</span> <span class="o">=</span> <span class="p">[]</span></pre>
<pre class='cython code score-5'>  __pyx_t_5 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 542; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  __pyx_cur_scope-&gt;__pyx_v_overlaps = ((PyObject*)__pyx_t_5);
  __pyx_t_5 = 0;
</pre><pre class='cython line score-22' onclick='toggleDiv(this)'>+543:         <span class="k">def</span> <span class="nf">overlap_fn</span><span class="p">(</span><span class="n">node</span><span class="p">):</span></pre>
<pre class='cython code score-22'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_1overlap_fn(PyObject *__pyx_self, PyObject *__pyx_v_node); /*proto*/
static PyMethodDef __pyx_mdef_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_1overlap_fn = {"overlap_fn", (PyCFunction)__pyx_pw_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_1overlap_fn, METH_O, 0};
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_1overlap_fn(PyObject *__pyx_self, PyObject *__pyx_v_node) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("overlap_fn (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_overlap_fn(__pyx_self, ((PyObject *)__pyx_v_node));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_overlap_fn(PyObject *__pyx_self, PyObject *__pyx_v_node) {
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect *__pyx_cur_scope;
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect *__pyx_outer_scope;
  PyObject *__pyx_v_iv = 0;
  float __pyx_v_ov_len;
  int __pyx_v_start;
  int __pyx_v_end;
  PyObject *__pyx_v_results = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("overlap_fn", 0);
  __pyx_outer_scope = (struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_2_coverage_intersect *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.coverage_intersect.overlap_fn", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_iv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_results);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(6, __pyx_n_s_node, __pyx_n_s_iv, __pyx_n_s_ov_len, __pyx_n_s_start, __pyx_n_s_end, __pyx_n_s_results);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
/* … */
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_6joshua_12intervaltree_12IntervalTree_18coverage_intersect_1overlap_fn, 0, __pyx_n_s_coverage_intersect_locals_overla, ((PyObject*)__pyx_cur_scope), __pyx_n_s_joshua_intervaltree, __pyx_d, ((PyObject *)__pyx_codeobj__8));<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_v_overlap_fn = __pyx_t_5;
  __pyx_t_5 = 0;
  __pyx_codeobj__8 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 6, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_home_camille_w_joshua_joshua_in, __pyx_n_s_overlap_fn, 543, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+544:             <span class="k">cdef</span> <span class="kt">object</span> <span class="nf">iv</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">interval</span></pre>
<pre class='cython code score-2'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_node, __pyx_n_s_interval);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 544; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_iv = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;545:             <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">ov_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+546:             <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">start</span> <span class="o">=</span> <span class="n">iv</span><span class="o">.</span><span class="n">start</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iv, __pyx_n_s_start);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 546; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_start = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+547:             <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">end</span> <span class="o">=</span> <span class="n">iv</span><span class="o">.</span><span class="n">end</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iv, __pyx_n_s_end);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_end = __pyx_t_2;
</pre><pre class='cython line score-40' onclick='toggleDiv(this)'>+548:             <span class="k">cdef</span> <span class="kt">list</span> <span class="nf">results</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></pre>
<pre class='cython code score-40'>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_other)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("other"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_cur_scope-&gt;__pyx_v_other, __pyx_n_s_find);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_end);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = NULL;
  __pyx_t_7 = 0;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_6)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_7 = 1;
    }
  }
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (__pyx_t_6) {
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_6); __pyx_t_6 = NULL;
  }
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_7, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_7, __pyx_t_5);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (!(likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1))||((__pyx_t_1) == Py_None)||(<span class='py_c_api'>PyErr_Format</span>(PyExc_TypeError, "Expected %.16s, got %.200s", "list", Py_TYPE(__pyx_t_1)-&gt;tp_name), 0))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 548; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_results = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+549:             <span class="k">if</span> <span class="n">results</span><span class="p">:</span></pre>
<pre class='cython code score-1'>  __pyx_t_9 = (__pyx_v_results != Py_None) &amp;&amp; (<span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_v_results) != 0);
  if (__pyx_t_9) {
</pre><pre class='cython line score-32' onclick='toggleDiv(this)'>+550:                 <span class="n">ov_len</span> <span class="o">=</span> <span class="n">calc_bases_overlapped_mult</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span> <span class="n">results</span><span class="p">)</span></pre>
<pre class='cython code score-32'>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_calc_bases_overlapped_mult);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_8 = NULL;
    __pyx_t_7 = 0;
    if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        __pyx_t_7 = 1;
      }
    }
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_8) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_8); __pyx_t_8 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_iv);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_iv);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_7, __pyx_v_iv);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_results);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_results);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_7, __pyx_v_results);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_10 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_10 == (float)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 550; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_ov_len = __pyx_t_10;
</pre><pre class='cython line score-10' onclick='toggleDiv(this)'>+551:                 <span class="k">if</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">ov_len</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">iv</span><span class="p">))</span> <span class="o">&gt;=</span> <span class="n">cutoff</span><span class="p">:</span></pre>
<pre class='cython code score-10'>    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_iv);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    if (unlikely(__pyx_t_7 == 0)) {
      #ifdef WITH_THREAD
      PyGILState_STATE __pyx_gilstate_save = PyGILState_Ensure();
      #endif
      <span class='py_c_api'>PyErr_SetString</span>(PyExc_ZeroDivisionError, "float division");
      #ifdef WITH_THREAD
      PyGILState_Release(__pyx_gilstate_save);
      #endif
      <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 551; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    }
    __pyx_t_9 = (((((double)__pyx_v_ov_len) / __pyx_t_7) &gt;= __pyx_cur_scope-&gt;__pyx_v_cutoff) != 0);
    if (__pyx_t_9) {
</pre><pre class='cython line score-24' onclick='toggleDiv(this)'>+552:                     <span class="n">overlaps</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">iv</span><span class="o">.</span><span class="n">idx</span><span class="p">,</span> <span class="n">ov_len</span><span class="p">))</span></pre>
<pre class='cython code score-24'>      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_overlaps)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("overlaps"); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span> }
      if (unlikely(__pyx_cur_scope-&gt;__pyx_v_overlaps == Py_None)) {
        <span class='py_c_api'>PyErr_Format</span>(PyExc_AttributeError, "'NoneType' object has no attribute '%s'", "append");
        <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      }
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_iv, __pyx_n_s_idx);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_ov_len);<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1, __pyx_t_3);
      __pyx_t_1 = 0;
      __pyx_t_3 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_cur_scope-&gt;__pyx_v_overlaps, __pyx_t_5);<span class='error_goto'> if (unlikely(__pyx_t_11 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 552; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      goto __pyx_L4;
    }
    __pyx_L4:;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-27' onclick='toggleDiv(this)'>+553:         <span class="bp">self</span><span class="o">.</span><span class="n">traverse</span><span class="p">(</span><span class="n">overlap_fn</span><span class="p">)</span></pre>
<pre class='cython code score-27'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_traverse);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
    }
  }
  if (!__pyx_t_3) {
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_4, __pyx_v_overlap_fn);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  } else {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_3); __pyx_t_3 = NULL;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_overlap_fn);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_overlap_fn);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+1, __pyx_v_overlap_fn);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 553; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+554:         <span class="k">return</span> <span class="n">overlaps</span></pre>
<pre class='cython code score-2'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_overlaps);
  __pyx_r = __pyx_cur_scope-&gt;__pyx_v_overlaps;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;555: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+556:     <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-0'>/* Python wrapper */
static Py_ssize_t __pyx_pw_6joshua_12intervaltree_12IntervalTree_27__len__(PyObject *__pyx_v_self); /*proto*/
static Py_ssize_t __pyx_pw_6joshua_12intervaltree_12IntervalTree_27__len__(PyObject *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__len__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_26__len__(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static Py_ssize_t __pyx_pf_6joshua_12intervaltree_12IntervalTree_26__len__(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self) {
  Py_ssize_t __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__len__", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
static PyObject *__pyx_gb_6joshua_12intervaltree_12IntervalTree_30generator1(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value); /* proto */
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+557:         <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_self-&gt;size;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;558: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+559:     <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span></pre>
<pre class='cython code score-19'>/* Python wrapper */
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_29__iter__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_6joshua_12intervaltree_12IntervalTree_29__iter__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__ (wrapper)", 0);
  __pyx_r = __pyx_pf_6joshua_12intervaltree_12IntervalTree_28__iter__(((struct __pyx_obj_6joshua_12intervaltree_IntervalTree *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_6joshua_12intervaltree_12IntervalTree_28__iter__(struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self) {
  struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_3___iter__ *__pyx_cur_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__iter__", 0);
  __pyx_cur_scope = (struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_3___iter__ *)__pyx_tp_new_6joshua_12intervaltree___pyx_scope_struct_3___iter__(__pyx_ptype_6joshua_12intervaltree___pyx_scope_struct_3___iter__, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return NULL;
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  __pyx_cur_scope-&gt;__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  {
    __pyx_GeneratorObject *gen = <span class='pyx_c_api'>__Pyx_Generator_New</span>((__pyx_generator_body_t) __pyx_gb_6joshua_12intervaltree_12IntervalTree_30generator1, (PyObject *) __pyx_cur_scope, __pyx_n_s_iter, __pyx_n_s_IntervalTree___iter);<span class='error_goto'> if (unlikely(!gen)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    return (PyObject *) gen;
  }

  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("joshua.intervaltree.IntervalTree.__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_gb_6joshua_12intervaltree_12IntervalTree_30generator1(__pyx_GeneratorObject *__pyx_generator, PyObject *__pyx_sent_value) /* generator body */
{
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("None", 0);
  __pyx_L3_first_run:;
  if (unlikely(!__pyx_sent_value)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 559; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
/* … */
  /* function exit code */
  <span class='py_c_api'>PyErr_SetNone</span>(PyExc_StopIteration);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("__iter__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_generator-&gt;resume_label = -1;
  <span class='pyx_c_api'>__Pyx_Generator_clear</span>((PyObject*)__pyx_generator);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
}
/* … */
struct __pyx_obj_6joshua_12intervaltree___pyx_scope_struct_3___iter__ {
  PyObject_HEAD
  PyObject *__pyx_v_iv;
  struct __pyx_obj_6joshua_12intervaltree_IntervalTree *__pyx_v_self;
  PyObject *__pyx_t_0;
  Py_ssize_t __pyx_t_1;
  PyObject *(*__pyx_t_2)(PyObject *);
};


</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+560:         <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;root) == Py_None);
  __pyx_t_2 = (__pyx_t_1 != 0);
  if (__pyx_t_2) {
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+561:             <span class="k">return</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    goto __pyx_L0;
  }
</pre><pre class='cython line score-46' onclick='toggleDiv(this)'>+562:         <span class="k">for</span> <span class="n">iv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">:</span></pre>
<pre class='cython code score-46'>  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;root))) || <span class='py_c_api'>PyTuple_CheckExact</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;root))) {
    __pyx_t_3 = ((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;root); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_4 = 0;
    __pyx_t_5 = NULL;
  } else {
    __pyx_t_4 = -1; __pyx_t_3 = <span class='py_c_api'>PyObject_GetIter</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self-&gt;root));<span class='error_goto'> if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_5 = Py_TYPE(__pyx_t_3)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  for (;;) {
    if (likely(!__pyx_t_5)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_3))) {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      } else {
        if (__pyx_t_4 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_3)) break;
        #if CYTHON_COMPILING_IN_CPYTHON
        __pyx_t_6 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_3, __pyx_t_4); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6); __pyx_t_4++;<span class='error_goto'> if (unlikely(0 &lt; 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        #else
        __pyx_t_6 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_3, __pyx_t_4); __pyx_t_4++;<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        #endif
      }
    } else {
      __pyx_t_6 = __pyx_t_5(__pyx_t_3);
      if (unlikely(!__pyx_t_6)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(exc_type == PyExc_StopIteration || <span class='py_c_api'>PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 562; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    }
    <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_cur_scope-&gt;__pyx_v_iv, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    __pyx_t_6 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class='cython line score-1' onclick='toggleDiv(this)'>+563:             <span class="k">yield</span> <span class="n">iv</span></pre>
<pre class='cython code score-1'>    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_iv);
    __pyx_r = __pyx_cur_scope-&gt;__pyx_v_iv;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_3);
    __pyx_cur_scope-&gt;__pyx_t_0 = __pyx_t_3;
    __pyx_cur_scope-&gt;__pyx_t_1 = __pyx_t_4;
    __pyx_cur_scope-&gt;__pyx_t_2 = __pyx_t_5;
    <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
    <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
    /* return from generator, yielding value */
    __pyx_generator-&gt;resume_label = 1;
    return __pyx_r;
    __pyx_L7_resume_from_yield:;
    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_t_0;
    __pyx_cur_scope-&gt;__pyx_t_0 = 0;
    <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);
    __pyx_t_4 = __pyx_cur_scope-&gt;__pyx_t_1;
    __pyx_t_5 = __pyx_cur_scope-&gt;__pyx_t_2;
    if (unlikely(!__pyx_sent_value)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 563; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-0'>&#xA0;564: </pre>
<pre class='cython line score-0'>&#xA0;565: <span class="c"># For backward compatibility</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+566: <span class="n">Intersecter</span> <span class="o">=</span> <span class="n">IntervalTree</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Intersecter, ((PyObject *)((PyObject*)__pyx_ptype_6joshua_12intervaltree_IntervalTree))) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 566; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre></div></body></html>
